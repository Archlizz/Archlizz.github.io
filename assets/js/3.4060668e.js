(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{462:function(t,e,r){"use strict";var n=r(11),i=r(86),o=r(33),s=r(51),a=r(134),u=r(135),h=Math.max,l=Math.min,c=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;r(136)("replace",2,(function(t,e,r,d){return[function(n,i){var o=t(this),s=null==n?void 0:n[e];return void 0!==s?s.call(n,o,i):r.call(String(o),n,i)},function(t,e){var i=d(r,t,this,e);if(i.done)return i.value;var c=n(t),f=String(this),p="function"==typeof e;p||(e=String(e));var v=c.global;if(v){var y=c.unicode;c.lastIndex=0}for(var m=[];;){var b=u(c,f);if(null===b)break;if(m.push(b),!v)break;""===String(b[0])&&(c.lastIndex=a(f,o(c.lastIndex),y))}for(var x,w="",O=0,T=0;T<m.length;T++){b=m[T];for(var S=String(b[0]),P=h(l(s(b.index),f.length),0),k=[],R=1;R<b.length;R++)k.push(void 0===(x=b[R])?x:String(x));var j=b.groups;if(p){var M=[S].concat(k,P,f);void 0!==j&&M.push(j);var U=String(e.apply(void 0,M))}else U=g(S,f,P,k,j,e);P>=O&&(w+=f.slice(O,P)+U,O=P+S.length)}return w+f.slice(O)}];function g(t,e,n,o,s,a){var u=n+t.length,h=o.length,l=p;return void 0!==s&&(s=i(s),l=f),r.call(a,l,(function(r,i){var a;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(u);case"<":a=s[i.slice(1,-1)];break;default:var l=+i;if(0===l)return r;if(l>h){var f=c(l/10);return 0===f?r:f<=h?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):r}a=o[l-1]}return void 0===a?"":a}))}}))},463:function(t,e,r){var n=r(86),i=r(50);r(467)("keys",(function(){return function(t){return i(n(t))}}))},465:function(t,e,r){"use strict";var n=r(11),i=r(33),o=r(134),s=r(135);r(136)("match",1,(function(t,e,r,a){return[function(r){var n=t(this),i=null==r?void 0:r[e];return void 0!==i?i.call(r,n):new RegExp(r)[e](String(n))},function(t){var e=a(r,t,this);if(e.done)return e.value;var u=n(t),h=String(this);if(!u.global)return s(u,h);var l=u.unicode;u.lastIndex=0;for(var c,f=[],p=0;null!==(c=s(u,h));){var d=String(c[0]);f[p]=d,""===d&&(u.lastIndex=o(h,i(u.lastIndex),l)),p++}return 0===p?null:f}]}))},467:function(t,e,r){var n=r(10),i=r(52),o=r(12);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],s={};s[t]=e(r),n(n.S+n.F*o((function(){r(1)})),"Object",s)}},488:function(t,e,r){var n=r(8),i=r(52),o=r(89),s=r(489),a=r(26).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},489:function(t,e,r){e.f=r(4)},490:function(t,e){e.f=Object.getOwnPropertySymbols},553:function(t,e,r){"use strict";var n=r(10),i=r(29),o=r(51),s=r(33),a=[].lastIndexOf,u=!!a&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(u||!r(87)(a)),"Array",{lastIndexOf:function(t){if(u)return a.apply(this,arguments)||0;var e=i(this),r=s(e.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}})},554:function(t,e,r){"use strict";r(555);var n=r(11),i=r(137),o=r(7),s=/./.toString,a=function(t){r(27)(RegExp.prototype,"toString",t,!0)};r(12)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?a((function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)})):"toString"!=s.name&&a((function(){return s.call(this)}))},555:function(t,e,r){r(7)&&"g"!=/./g.flags&&r(26).f(RegExp.prototype,"flags",{configurable:!0,get:r(137)})},556:function(t,e,r){var n=Date.prototype,i=n.toString,o=n.getTime;new Date(NaN)+""!="Invalid Date"&&r(27)(n,"toString",(function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"}))},557:function(t,e,r){var n=r(10);n(n.P,"Function",{bind:r(558)})},558:function(t,e,r){"use strict";var n=r(92),i=r(13),o=r(559),s=[].slice,a={},u=function(t,e,r){if(!(e in a)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";a[e]=Function("F,a","return new F("+n.join(",")+")")}return a[e](t,r)};t.exports=Function.bind||function(t){var e=n(this),r=s.call(arguments,1),a=function(){var n=r.concat(s.call(arguments));return this instanceof a?u(e,n.length,n):o(e,n,t)};return i(e.prototype)&&(a.prototype=e.prototype),a}},559:function(t,e){t.exports=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},560:function(t,e,r){var n=r(10);n(n.S,"Object",{create:r(91)})},561:function(t,e,r){t.exports=r(148)},562:function(t,e,r){t.exports=r(150)},563:function(t,e,r){r(488)("asyncIterator")},564:function(t,e,r){"use strict";var n=r(8),i=r(21),o=r(7),s=r(10),a=r(27),u=r(565).KEY,h=r(12),l=r(58),c=r(94),f=r(54),p=r(4),d=r(489),g=r(488),v=r(566),y=r(140),m=r(11),b=r(13),x=r(86),w=r(29),O=r(56),T=r(57),S=r(91),P=r(567),k=r(97),R=r(490),j=r(26),M=r(50),U=k.f,F=j.f,L=P.f,A=n.Symbol,E=n.JSON,I=E&&E.stringify,C=p("_hidden"),D=p("toPrimitive"),H={}.propertyIsEnumerable,N=l("symbol-registry"),B=l("symbols"),q=l("op-symbols"),W=Object.prototype,_="function"==typeof A&&!!R.f,K=n.QObject,J=!K||!K.prototype||!K.prototype.findChild,z=o&&h((function(){return 7!=S(F({},"a",{get:function(){return F(this,"a",{value:7}).a}})).a}))?function(t,e,r){var n=U(W,e);n&&delete W[e],F(t,e,r),n&&t!==W&&F(W,e,n)}:F,$=function(t){var e=B[t]=S(A.prototype);return e._k=t,e},X=_&&"symbol"==typeof A.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof A},G=function(t,e,r){return t===W&&G(q,e,r),m(t),e=O(e,!0),m(r),i(B,e)?(r.enumerable?(i(t,C)&&t[C][e]&&(t[C][e]=!1),r=S(r,{enumerable:T(0,!1)})):(i(t,C)||F(t,C,T(1,{})),t[C][e]=!0),z(t,e,r)):F(t,e,r)},Y=function(t,e){m(t);for(var r,n=v(e=w(e)),i=0,o=n.length;o>i;)G(t,r=n[i++],e[r]);return t},Q=function(t){var e=H.call(this,t=O(t,!0));return!(this===W&&i(B,t)&&!i(q,t))&&(!(e||!i(this,t)||!i(B,t)||i(this,C)&&this[C][t])||e)},V=function(t,e){if(t=w(t),e=O(e,!0),t!==W||!i(B,e)||i(q,e)){var r=U(t,e);return!r||!i(B,e)||i(t,C)&&t[C][e]||(r.enumerable=!0),r}},Z=function(t){for(var e,r=L(w(t)),n=[],o=0;r.length>o;)i(B,e=r[o++])||e==C||e==u||n.push(e);return n},tt=function(t){for(var e,r=t===W,n=L(r?q:w(t)),o=[],s=0;n.length>s;)!i(B,e=n[s++])||r&&!i(W,e)||o.push(B[e]);return o};_||(a((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(r){this===W&&e.call(q,r),i(this,C)&&i(this[C],t)&&(this[C][t]=!1),z(this,t,T(1,r))};return o&&J&&z(W,t,{configurable:!0,set:e}),$(t)}).prototype,"toString",(function(){return this._k})),k.f=V,j.f=G,r(138).f=P.f=Z,r(90).f=Q,R.f=tt,o&&!r(89)&&a(W,"propertyIsEnumerable",Q,!0),d.f=function(t){return $(p(t))}),s(s.G+s.W+s.F*!_,{Symbol:A});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;et.length>rt;)p(et[rt++]);for(var nt=M(p.store),it=0;nt.length>it;)g(nt[it++]);s(s.S+s.F*!_,"Symbol",{for:function(t){return i(N,t+="")?N[t]:N[t]=A(t)},keyFor:function(t){if(!X(t))throw TypeError(t+" is not a symbol!");for(var e in N)if(N[e]===t)return e},useSetter:function(){J=!0},useSimple:function(){J=!1}}),s(s.S+s.F*!_,"Object",{create:function(t,e){return void 0===e?S(t):Y(S(t),e)},defineProperty:G,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt});var ot=h((function(){R.f(1)}));s(s.S+s.F*ot,"Object",{getOwnPropertySymbols:function(t){return R.f(x(t))}}),E&&s(s.S+s.F*(!_||h((function(){var t=A();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))}))),"JSON",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(b(e)||void 0!==t)&&!X(t))return y(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!X(e))return e}),n[1]=e,I.apply(E,n)}}),A.prototype[D]||r(14)(A.prototype,D,A.prototype.valueOf),c(A,"Symbol"),c(Math,"Math",!0),c(n.JSON,"JSON",!0)},565:function(t,e,r){var n=r(54)("meta"),i=r(13),o=r(21),s=r(26).f,a=0,u=Object.isExtensible||function(){return!0},h=!r(12)((function(){return u(Object.preventExtensions({}))})),l=function(t){s(t,n,{value:{i:"O"+ ++a,w:{}}})},c=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[n].i},getWeak:function(t,e){if(!o(t,n)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[n].w},onFreeze:function(t){return h&&c.NEED&&u(t)&&!o(t,n)&&l(t),t}}},566:function(t,e,r){var n=r(50),i=r(490),o=r(90);t.exports=function(t){var e=n(t),r=i.f;if(r)for(var s,a=r(t),u=o.f,h=0;a.length>h;)u.call(t,s=a[h++])&&e.push(s);return e}},567:function(t,e,r){var n=r(29),i=r(138).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return s.slice()}}(t):i(n(t))}},568:function(t,e,r){var n=r(10);n(n.S+n.F*!r(7),"Object",{defineProperty:r(26).f})},619:function(t,e,r){"use strict";r.r(e);r(465),r(145),r(144),r(462),r(553),r(88),r(463),r(554),r(556),r(142),r(143),r(557),r(560);var n=r(561),i=r.n(n),o=r(562),s=r.n(o);function a(t){return(a="function"==typeof s.a&&"symbol"==typeof i.a?function(t){return typeof t}:function(t){return t&&"function"==typeof s.a&&t.constructor===s.a&&t!==s.a.prototype?"symbol":typeof t})(t)}r(563),r(564),r(568);!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==a(t)&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){r(1)},function(t,e){var r,n="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(t){return a(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":a(t)};!function(t){!function(t){var e={type:"GET",async:!0,contentType:"application/x-www-form-urlencoded",dataType:"string",cache:!1,timeout:3e4,processData:!0};t.ajax=function(r){var n=function(){var t;try{t=new XMLHttpRequest}catch(i){for(var e=["Msxml3.XMLHTTP","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],r=0,n=e.length;r<n;r++)try{t=new ActiveXObject(e[r])}catch(t){continue}}return t}();if(null!=n&&n){var i={};if(t.Utils.extend(!0,i,e),t.Utils.extend(!0,i,r),(r=i).async)try{n.timeout=r.timeout,n.ontimeout=function(){r.error&&r.error(n,"timeout"),r.complete&&r.complete(n,"timeout")}}catch(e){t.logger.error(e.Message,e)}n.onreadystatechange=function(){if(n.readyState<4)r.loading&&r.loading(n.readyState);else{if(r.success&&(0==n.status||n.status>=200&&n.status<300)){var e=n.response;null==e&&(e=n.responseText);try{i=e,"json"==r.dataType&&"string"==t.Utils.type(i)&&(i=JSON.parse(i)),e=i}catch(t){return void(r.error&&r.error(n,t.message))}r.success(e,n.status,n)}else r.error&&r.error(n,n.status);var i;r.complete&&r.complete(n,n.status)}};try{var o=r.url;if(r.type&&"GET"===r.type.toUpperCase()&&(o=function(e,r,n){if(null==r)return e;void 0===n&&(n="text");var i="";if(0===(n=n.trim().toLowerCase()).indexOf("application/x-www-form-urlencoded")||0===n.indexOf("application/json"))if("object"==t.Utils.type(r))for(var o in r){var s=r[o];if("array"==t.Utils.type(s))for(var a=0;a<s.length;a++){var u=o+"="+encodeURIComponent(s[a]);i.length>0&&(i+="&"),i+=u}else u=o+"="+encodeURIComponent(s),i.length>0&&(i+="&"),i+=u}else i=r;else i=r;return-1==e.indexOf("?")?(e+="?",e+=i):(e+="&",e+=i),e}(r.url,r.data,r.contentType)),n.open(r.type,o,r.async),r.contentType&&n.setRequestHeader("Content-Type",r.contentType),"function"==t.Utils.type(r.beforeSend)){var s={};t.Utils.extend(!0,s,r),r.beforeSend.call(this,n,s)}if(r.cache||n.setRequestHeader("Cache-Control","no-cache"),r.type&&"POST"===r.type.toUpperCase()){var a=r.processData?function(e,r){void 0===r&&(r="text");var n="";if(0==(r=r.trim().toLowerCase()).indexOf("application/x-www-form-urlencoded"))if("object"==t.Utils.type(e))for(var i in e){var o=e[i];if("array"==t.Utils.type(o))for(var s=0;s<o.length;s++){var a=i+"="+encodeURIComponent(o[s]);n.length>0&&(n+="&"),n+=a}else a=i+"="+encodeURIComponent(o),n.length>0&&(n+="&"),n+=a}else n=e;else n=0==r.indexOf("text")?"object"==t.Utils.type(e)?JSON.stringify(e):e:0==r.indexOf("application/json")&&"object"==t.Utils.type(e)?JSON.stringify(e):e;return n}(r.data,r.contentType):r.data;n.send(a)}else n.send()}catch(t){r.error&&r.error(n,t.message),r.complete&&r.complete(n,t.message)}return n}t.logger.error("not support XmlHttpRequest")}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(){}return t.prototype.warn=function(t,e){return this},t.prototype.error=function(t,e){return this},t.prototype.info=function(t){return this},t.prototype.debug=function(t){return this},t}();t.Logger=e,t.logger=window.console?window.console:new e}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(t){this.children={},this.id=t},r=function(){function r(){this.root=new e("_root_")}return r.prototype.put=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r.length;if(i<2)return t.logger.error("参数至少包括一个(key,value)"),!1;for(var o=this.root,s=0;s<i-1;s++){var a=r[s];o.children[a]||(o.children[a]=new e(a)),o=o.children[a]}return o.data=arguments[i-1],!0},r.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t.length;if(0!=r){for(var n=this.root,i=0;i<r;i++){var o=t[i];if(!n.children[o])return;n=n.children[o]}return n.data}},r.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t.length;if(0==r)return!1;for(var n=this.root,i=0;i<r-1;i++){var o=t[i];if(!n.children[o])return!1;n=n.children[o]}var s=t[r-1];return!!n.children[s]&&(delete n.children[s],!0)},r}();t.Bus=r}(t.core||(t.core={}))}(r||(r={})),function(t){!function(e){var r=function(){function e(){}return e.type=function(t){var r=Object.prototype.toString.call(t);return null==t?String(t):e.class2type[r]||"object"},e.isFunction=function(t){return"function"===e.type(t)},e.isArray=function(t){return"array"===e.type(t)},e.makeArray=function(t,r){var n=r||[];return null!=t&&(e.isArrayLike(Object(t))?e.merge(n,"string"==typeof t?[t]:t):n.push(t)),n},e.merge=function(t,e){for(var r=+e.length,n=0,i=t.length;n<r;n++)t[i++]=e[n];return t.length=i,t},e.isWindow=function(t){return t&&"object"===(void 0===t?"undefined":n(t))&&"setInterval"in t},e.isPlainObject=function(t){if(!t||"object"!==e.type(t)||t.nodeType||e.isWindow(t))return!1;var r,n=Object.prototype.hasOwnProperty;if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1;for(r in t);return void 0===r||n.call(t,r)},e.extend=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t[0]||{},o=1,s=t.length,a=!1;for("boolean"==typeof i&&(a=i,i=t[o]||{},o++),"object"===(void 0===i?"undefined":n(i))||e.isFunction(i)||(i={}),o===s&&(i=this,o--);o<s;o++)if(null!=t[o]&&null!=t[o]){var u=t[o];for(var h in u){var l=i[h],c=u[h];if(i!==c){var f,p=!1;if(a&&c&&(e.isPlainObject(c)||(p=e.isArray(c))))f=p?l&&e.isArray(l)?l:[]:l&&e.isPlainObject(l)?l:{},i[h]=e.extend(a,f,c);else void 0!==c&&(i[h]=c)}}}return i},e.clone=function(t,r){return e.extend(!0,r,t)},e.isArrayLike=function(t){var r=!!t&&"length"in t&&t.length,n=e.type(t);return"function"!==n&&!e.isWindow(t)&&("array"===n||0===r||"number"==typeof r&&r>0&&r-1 in t)},e.isEqual=function(e,r){if(e==r)return!0;if(void 0===e||void 0===r)return!1;var n=t.type(e);if(n!==t.type(r))return!1;if("object"===n){var i=Object.keys(e),o=Object.keys(r);if(i.length!==o.length)return!1;for(var s=0;s<i.length;s++){var a=i[s],u=e[a],h=r[a];if(!this.isEqual(u,h))return!1}return!0}if("array"===n){if(e.length!==r.length)return!1;for(s=0;s<e.length;s++){var l=e[s],c=r[s];if(!this.isEqual(l,c))return!1}return!0}return!1},e.each=function(t,r,n){if(e.isArrayLike(t))for(var i=t.length,o=0;o<i&&!1!==r.call(t[o],o,t[o]);o++);else for(var s in t)if(n){if(t.hasOwnProperty(s)&&!1===r.call(t[s],s,t[s]))break}else if(!1===r.call(t[s],s,t[s]))break;return t},e.getInnerText=function(t){return"string"==typeof t.innerText?t.innerText:t.textContent},e.setInnerText=function(t,e){"string"==typeof t.innerText?t.innerText=e:t.textContent=e},e.getNextElementSibling=function(t){return t.nextElementSibling?t.nextElementSibling:t.nextSibling},e.getFirstElementChild=function(t){return t.firstElementChild?t.firstElementChild:t.firstChild},e.class2type={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Object]":"object"},e}();e.Utils=r}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e;!function(t){t[t.Running=0]="Running",t[t.Done=1]="Done",t[t.Fail=2]="Fail"}(e||(e={}));var r=function(){function t(){this.doneFns=[],this.failFns=[],this.alwaysFns=[],this.status=e.Running}return t.prototype.fire=function(){if(this.status!=e.Running){if(this.alwaysFns)for(;this.alwaysFns.length>0;)this.alwaysFns.shift().apply(this,this.args);if(this.status==e.Done)for(;this.doneFns.length>0;)this.doneFns.shift().apply(this,this.args);else if(this.status==e.Fail)for(;this.failFns.length>0;)this.failFns.shift().apply(this,this.args)}},t.prototype.done=function(t){return this.doneFns.push(t),this.fire(),this},t.prototype.fail=function(t){return this.failFns.push(t),this.fire(),this},t.prototype.always=function(t){return this.alwaysFns.push(t),this.fire(),this},t.prototype.resolve=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.args=t,this.status=e.Done,this.fire(),this},t.prototype.reject=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.args=t,this.status=e.Fail,this.fire(),this},t}();t.Deferred=r}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function e(){this.handlers=[]}return e.prototype.register=function(t){this.handlers.push(t)},e.prototype.handle=function(e,r,n){for(var i=0;i<this.handlers.length;i++)try{this.handlers[i].handle(e,r,n)}catch(n){t.logger.error(n.Message,n)}},e}();t.ErrorHandler=e,t.errorHandler=new e}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(){}return t.Busy="busy",t.Free="free",t.Reject="reject",t.Exception="exception",t}(),r=function(){function r(){this.waitFns=[],this.exceptionFns=[],this.chain=[],this.status=e.Free}return r.prototype.fire=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.args=t,this.status!=e.Exception)if(this.status!=e.Reject)if(0!=this.chain.length){if(this.status=e.Busy,this.chain.length>0){var n=this.chain.shift();try{n.apply(this,this.args)}catch(t){this.throw(t)}}}else{for(;this.waitFns.length>0;)this.waitFns.shift().apply(this,this.args);this.status=e.Free}else for(;this.waitFns.length>0;)this.waitFns.shift().apply(this,this.args);else for(;this.exceptionFns.length>0;)this.exceptionFns.shift().apply(this,this.exArgs)},r.prototype.reject=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(this.status=e.Busy,this.args=t,this.chain=[];this.waitFns.length>0;)this.waitFns.shift().apply(this,this.args);this.status=e.Reject},r.prototype.throw=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(this.status=e.Busy,this.exArgs=t,this.chain=[];this.exceptionFns.length>0;)this.exceptionFns.shift().apply(this,this.exArgs);this.status=e.Exception},r.prototype.reset=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(this.status=e.Busy,this.args=t,this.chain=[];this.waitFns.length>0;)this.waitFns.shift().apply(this,this.args);this.status=e.Free},r.prototype.post=function(r){return this.status==e.Reject||this.status==e.Exception?this:("array"==t.Utils.type(r)?this.chain=[].concat(this.chain,r):this.chain.push(r),this.status==e.Busy?this:(this.fire.apply(this,this.args),this))},r.prototype.wait=function(t){return this.waitFns.push(t),this.status==e.Busy?this:(this.fire.apply(this,this.args),this)},r.prototype.exception=function(t){return this.exceptionFns.push(t),this.status==e.Busy?this:(this.fire.apply(this,this.args),this)},r.prototype.isFinish=function(){return this.status==e.Reject||this.status==e.Free&&0==this.chain.length},r}();t.EventChain=r}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e;!function(t){t[t.limitless=0]="limitless",t[t.once=1]="once"}(e||(e={}));var r=function(){function r(){this.register={}}return r.prototype.bind=function(t,r,n){var i=this.register[t];i||(i=[],this.register[t]=i);var o={policy:1==n?e.once:e.limitless,callback:r};return i.push(o),this},r.prototype.unbind=function(t){delete this.register[t]},r.prototype.once=function(t,e){return this.bind(t,e,!0)},r.prototype.all=function(){for(var e=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r.length;if(!(i<1)){var o=r[i-1];if(t.Utils.isFunction(o)){for(var s=i-1,a=new Array(s),u=[].splice.call(r,0,s),h=function(t){l.once(u[t],(function(r){a[t]=r,0==(s-=1)&&o.apply(e,a)}))},l=this,c=0;c<u.length;c++)h(c);return this}t.logger.error("callback can not benn empty")}},r.prototype.trigger=function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=this.register[r];if(o){for(var s=0;s<o.length;s++){var a=o[s];if(a.policy==e.once&&o.slice(s,1),a.callback)try{a.callback.apply(this,n)}catch(e){t.logger.error(e.message,e)}}return this}},r.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.trigger(t,e)},r}();t.EventProxy=r}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=window,r=function(){function r(t,r){var n=this;this.maxSize=20,this.list=new Array,this.cursor=-1,this.lockHashEvent=!1,this.maxSize=t,this.router=r,e.addEventListener?e.addEventListener("hashchange",(function(){n.hashChange()}),!1):e.attachEvent?e.attachEvent("onhashchange",(function(){n.hashChange()})):e.onhashchange=function(){n.hashChange()}}return r.prototype.getHash=function(){var t=e.location.hash,r=t.indexOf("#");if(-1!=r)return t.substring(r+1)},r.prototype.hashChange=function(){if(1!=this.lockHashEvent){var e=this.getHash();if(e){if(this.currentHash===e)return;var r=-1;if(this.cursor>0&&this.list[this.cursor-1].target.path===e&&(r=this.cursor-1),-1==r&&this.cursor<this.list.length-1&&this.list[this.cursor+1].target.path===e&&(r=this.cursor+1),-1==r&&-1==(r=this.lastIndexOf(e)))return;this.cursor,this.cursor=r,this.currentHash=e;var n=this.get(r);n.target.cite=n.target.cite||{},n.target.cite.startTime=(new Date).getTime(),n.target.cite.back=!0,this.router.mount(n.target,n.pages,t.UpdatePolicy.All,t.LoadPolicy.Different,t.OperationType.Put)}}},r.prototype.indexOf=function(t,e){if(void 0===e&&(e=void 0),e){for(var r=0;r<this.list.length;r++)if((n=this.list[r]).target.path===t&&e===n.target.options.operationType)return r}else for(r=0;r<this.list.length;r++){var n;if((n=this.list[r]).target.path===t)return r}return-1},r.prototype.lastIndexOf=function(t,e,r){if(void 0===e&&(e=void 0),void 0===r&&(r=-1),r=null==r||-1==r?this.list.length-1:r,e){for(var n=r;n>=0;n--)if((i=this.list[n]).target.path===t&&e===i.target.options.operationType)return n}else for(n=r;n>=0;n--){var i;if((i=this.list[n]).target.path===t)return n}return-1},r.prototype.get=function(t){if(!(t<0||t>=this.list.length))return this.list[t].clone()},r.prototype.length=function(){return this.list.length},r.prototype.position=function(t){if(t<0||t>=this.list.length)return!1;var r=this.list[t];this.currentHash=r.target.path;var n=t-this.cursor;return 0!=n&&e.history.go(n),this.cursor=t,!0},r.prototype.replace=function(t,e){this.cursor<0||this.cursor>=this.list.length||(this.list[this.cursor].pages=e)},r.prototype.push=function(t,r){var i,o=new n;return o.target=t,o.pages=r,this.cursor++,this.cursor<this.list.length?(this.list[this.cursor]=o,(i=this.cursor-this.maxSize)<0&&(i=0),this.cursor>i&&(this.list=this.list.splice(i,this.cursor+1)),this.cursor=this.list.length-1):(this.list.push(o),(i=this.cursor-this.maxSize)>0&&(this.cursor>i&&(this.list=this.list.splice(i,this.cursor+1)),this.cursor=this.list.length-1)),this.currentHash=t.path,e.location.hash=t.path,!0},r.prototype.go=function(t){this.lockHashEvent=!0,e.history.go(t),this.lockHashEvent=!1;var r=this.getHash(),n=this.lastIndexOf(r);if(n!==this.cursor&&-1!=n)return this.position(n),this.list[n]},r}();t.History=r;var n=function(){function e(){}return e.prototype.clone=function(){for(var r=t.Utils.extend({},this.target),n=[],i=0;i<this.pages.length;i++)n.push(this.pages[i]);var o=new e;return o.target=r,o.pages=n,o},e}();t.HistoryNode=n}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function e(){this.cache={}}return e.prototype.get=function(e,r,n){if(this.cache[e]){var i=this.cache[e];n.call(this,0,i)}else{var o=this;t.ajax({url:e,type:"GET",cache:!1,data:{},timeout:r,async:!0,success:function(t,r,i){o.cache[e]=t,n(0,t)},error:function(t,e){n(1,e)}})}},e}();t.Resource=e}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){!function(t){t[t.Loading=0]="Loading",t[t.Loaded=1]="Loaded",t[t.Defining=2]="Defining",t[t.Defined=3]="Defined"}(t.ModuleStatus||(t.ModuleStatus={}));t.Module=function(){};var e=function(){function t(){this.register={}}return t.prototype.get=function(t){return this.register[t]},t.prototype.put=function(t,e){this.register[t]=e},t.prototype.remove=function(t){var e=this.register[t];return delete this.register[t],e},t.prototype.contains=function(t){return!!this.register[t]},t.prototype.clear=function(){this.register={}},t}();t.Modules=e}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e;!function(t){t[t.Busy=0]="Busy",t[t.Free=1]="Free"}(e||(e={}));var r=function(){function e(t,e){this.size=t,this.callback=e,this.status=!0,this.values=[],this.lastIndex=-1}return e.prototype.work=function(e,r,n){if(this.status=e,1==this.status&&(this.lastIndex!=r&&this.size--,this.lastIndex=r,this.values.push(n)),0==this.size||0==this.status)try{this.callback.call(this,this.status,this.values)}catch(e){t.logger.error(e.Message,e)}},e.prototype.isOK=function(){return this.status},e}(),n=function(t,e,r,n){this.index=t,this.src=e,this.params=r,this.progress=n},i=function(){function i(){this.win=window,this.doc=document,this.head=this.doc.head||this.doc.getElementsByTagName("head")[0]||this.doc.documentElement,this.isOldWebKit=+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/(\d+).*/,"$1")<536,this.paths={},this.alias={},this.charset="UTF-8",this.timeout=-1,this.modules=new t.Modules,this.resource=new t.Resource,this.queue=[],this.status=e.Free,this.nature={},this.version="1.0.0",this.rootURL=this.getRelativeHref()}return i.prototype.getUrlPath=function(t){var e=t,r=e.lastIndexOf("/");return r>0&&r<e.length-1?e=e.substring(0,r+1):0==r&&-1!==e.indexOf(".")?e="/":-1==r&&(e=-1==e.indexOf(".")?"/"+e+"/":"/"),0!==e.indexOf("/")&&(e="/"+e),e},i.prototype.getRelativeHref=function(){var t=this.doc.location;return t.protocol+"//"+t.host+this.getUrlPath(t.pathname)},i.prototype.config=function(e){if(e)return this.paths=e.paths?t.Utils.extend({},e.paths):this.paths,this.alias=e.alias?t.Utils.clone({},e.alias):this.alias,null!=e.charset&&(this.charset=e.charset),null!=e.nature&&(this.nature=e.nature),null!=e.version&&(this.version=e.version),this},i.prototype.get=function(t,e,r){t=this.resolvePath(t);var n=this.timeout;return r&&r.timeout&&(n=r.timeout),this.resource.get(t,n,e),this},i.prototype.use=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.require.apply(this,t)},i.prototype.require=function(){for(var i=this,o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var a,u,h,l=[];h=o.length,a={},"object"==t.Utils.type(o[h-1])&&(t.Utils.extend(!0,a,o[h-1]),h--),"function"==t.Utils.type(o[h-1])&&(u=o[h-1],h--);for(var c=0;c<h;c++)if("array"===t.Utils.type(o[c])){for(var f=o[c],p=0;p<f.length;p++)if(null!=f[p]){var d=this.resolvePath(f[p]);l.push(d)}}else{var g=o[c].split(",");for(p=0;p<g.length;p++)null!=g[p]&&(d=this.resolvePath(g[p]),l.push(d))}var v=new t.Deferred;if(1==l.length&&this.modules.contains(l[0])){var y=this.modules.get(l[0]);if(y.status==t.ModuleStatus.Defined){var m=y.exports;m.done=function(t){v.done(t)},m.fail=function(t){v.fail(t)};try{u&&u.call(this,m)}catch(e){t.logger.error(e.Message,e)}try{v.resolve(y)}catch(e){t.logger.error(e.Message,e)}return m}}var b=new r(l.length,(function(e,r){if(b.isOK()){try{u&&u.apply(i,r)}catch(e){t.logger.error(e.Message,e)}try{v.resolve(r)}catch(e){t.logger.error(e.Message,e)}}else{try{u&&u.apply(i,r)}catch(e){t.logger.error(e.Message,e)}try{v.reject(r)}catch(e){t.logger.error(e.Message,e)}}}));for(c=0;c<l.length;c++){var x=new n(c,l[c],a,b);this.queue.push(x)}return this.status==e.Free&&this.execMountTask(),v},i.prototype.execMountTask=function(){if(0!=this.queue.length){this.status=e.Busy;var t=this.queue.shift();0!=t.progress.isOK()?this.mount(t):this.execMountTask()}else this.status=e.Free},i.prototype.mount=function(t){if(this.isNaturePath(t.src,"js"))return null==(e=t.params.jsPoint)&&(e=this.head),void this.mountJS(t,e);if(this.isNaturePath(t.src,"css"))return null==(e=t.params.cssPoint)&&(e=this.head),void this.mountCSS(t,e);if(this.isNaturePath(t.src,"html"))return null==(e=t.params.htmlPoint)&&(e=this.doc.body),void this.mountHTML(t,e);var e,r=this.getFileNamePostfix(t.src);return"js"===r||0===r.length?(null==(e=t.params.jsPoint)&&(e=this.head),void this.mountJS(t,e)):"css"===r?(null==(e=t.params.cssPoint)&&(e=this.head),void this.mountCSS(t,e)):(null==(e=t.params.htmlPoint)&&(e=this.doc.body),void this.mountHTML(t,e))},i.prototype.mountCSS=function(e,r){var n=this,i=e.src,o=this.doc.createElement("link");this.charset&&(o.charset=this.charset),o.setAttribute("crossorigin",!0);var s="onload"in o;if(this.isOldWebKit||!s){var a={timeout:this.timeout||3e3,time:0,isOldWebKit:this.isOldWebKit,success:function(){e.progress.work(!0,e.index,e.src),n.execMountTask()},error:function(){try{r.removeChild(o)}catch(e){t.logger.error(e.message,e)}e.progress.work(!1),n.execMountTask()}};setTimeout((function(){!function t(e,r){var n,i=e.sheet;if(r.isOldWebKit)i&&(n=!0);else if(i)try{i.cssRules&&(n=!0)}catch(t){"NS_ERROR_DOM_SECURITY_ERR"===t.name&&(n=!0)}setTimeout((function(){r.time+=20,n?r.success():r.time>r.timeout?r.error():t(e,r)}),20)}(o,a)}),1)}else o.onload=function(){o.onload=o.onerror=null,e.progress.work(!0,e.index,e.src),n.execMountTask()},o.onerror=function(){try{r.removeChild(o)}catch(e){t.logger.error(e.message,e)}o.onload=o.onerror=null,e.progress.work(!1),n.execMountTask()};var u=this.doc.getElementById(i);u&&u.parentNode.removeChild(u),o.async=!0,o.rel="stylesheet",o.type="text/css",o.id=i,o.href=i,r.appendChild(o)},i.prototype.mountHTML=function(e,r){var n=this,i=this.timeout;e.params.timeout&&(i=e.params.timeout);var o=e.src;this.resource.get(o,i,(function(i,o){0==i?(r.innerHTML=o,e.progress.work(!0,e.index,o)):(t.logger.error("code:"+i+",message:"+o),e.progress.work(!1)),n.execMountTask()}))},i.prototype.mountJS=function(e,r){var n=this,i=e.src,o=this.modules.get(i);if(o&&(o.status==t.ModuleStatus.Defined||o.status==t.ModuleStatus.Loaded))return e.progress.work(!0,e.index,o.exports),void this.execMountTask();(o=new t.Module).id=i,o.src=i,o.status=t.ModuleStatus.Loading,this.modules.put(i,o);var s=this.doc.createElement("script");s.setAttribute("crossorigin","true"),this.charset&&(s.charset=this.charset),"onload"in s?(s.onload=function(){s.onload=s.onerror=null,o.status==t.ModuleStatus.Loading&&(o.status=t.ModuleStatus.Loaded,e.progress.work(!0,e.index,i)),n.execMountTask()},s.onerror=function(){try{r.removeChild(s)}catch(e){t.logger.error(e.message,e)}s.onload=s.onerror=null,e.progress.work(!1),n.execMountTask()}):s.onreadystatechange=function(){/loaded|complete/.test(s.readyState)&&(s.onreadystatechange=null,o.status==t.ModuleStatus.Loading&&(o.status=t.ModuleStatus.Loaded,e.progress.work(!0,e.index,i)),n.execMountTask())},s.async=!0,s.src=i,this.win.define=this.createDefine(o,e),r.appendChild(s)},i.prototype.createDefine=function(e,r){var n=this,i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.require.apply(n,t)};return function(){for(var o,s,a,u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];e.status=t.ModuleStatus.Defining;var l=u.length;1===l?(a=u[0],o=void 0):2===l?(a=u[1],t.Utils.isArray(u[0])?(s=u[0],o=void 0):s=void 0):(o=u[0],s=u[1],a=u[2]),o&&(e.id=o,n.alias[o]=e.src),s?(s.length,n.require(s,(function(){"function"==t.Utils.type(a)?(e.exports={},a.call(e.exports,i,e.exports,e)):e.exports=a,e.status=t.ModuleStatus.Defined,r.progress.work(!0,r.index,e.exports)}))):("function"==t.Utils.type(a)?(e.exports={},a.call(e.exports,i,e.exports,e)):e.exports=a,e.status=t.ModuleStatus.Defined,r.progress.work(!0,r.index,e.exports))}},i.prototype.resolvePath=function(e){try{if(this.isNaturePath(e,"all"))return e;e=this.parserPath(e,!0);var r=this.getFileNamePostfix(e);return r=r.toLowerCase(),-1==e.indexOf("?")?("js"!=r&&"css"!=r&&"html"!=r&&(e+=".js"),e+="?version=",e+=this.version):(e+="&version=",e+=this.version),e}catch(r){throw t.logger.error("resolve path["+e+"] fail",r),r}},i.prototype.getFileNamePostfix=function(t){var e=t.lastIndexOf("?");-1==e&&(e=t.length);var r=t.lastIndexOf(".",e);return-1==r?"":t.substring(r+1,e)},i.prototype.isNaturePath=function(t,e){if(0===this.nature.length)return!1;var r;if(("all"===e||"js"===e)&&void 0!==(r=this.nature.js))for(var n=0;n<r.length;n++){var i=r[n];if(0===t.indexOf(i))return!0}if(("all"===e||"css"===e)&&void 0!==(r=this.nature.css))for(n=0;n<r.length;n++)if(i=r[n],0===t.indexOf(i))return!0;if(("all"===e||"html"===e)&&void 0!==(r=this.nature.html))for(n=0;n<r.length;n++)if(i=r[n],0===t.indexOf(i))return!0;return!1},i.prototype.parserPath=function(t,e){if(0==t.indexOf("http://"))return t;if(0==t.indexOf("https://"))return t;if(0==t.indexOf("file:///"))return t;if(0==t.indexOf("/"))return this.rootURL+t.slice(1);if(0==t.indexOf("./"))return this.getRelativeHref()+t.slice(2);if(e){var r=this.alias[t];if(!r){var n=t.indexOf("/");if(-1==n)r=t;else{var i=t.slice(0,n),o=this.paths[i];r=o?o+t.slice(n):t}}return this.parserPath(r,!1)}return this.getRelativeHref()+t},i}();t.Require=i,t.require=new i}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e,r,n,i,o=function(t){return void 0!==t},s="router";!function(t){t[t.Before=0]="Before",t[t.Mount=1]="Mount",t[t.Ready=2]="Ready",t[t.UnMount=3]="UnMount",t[t.Destroy=4]="Destroy"}(e=t.FilterType||(t.FilterType={})),function(t){t[t.Replace=0]="Replace",t[t.Push=1]="Push",t[t.Append=2]="Append",t[t.Put=3]="Put"}(r=t.OperationType||(t.OperationType={})),function(t){t[t.All=0]="All",t[t.Part=1]="Part"}(n=t.UpdatePolicy||(t.UpdatePolicy={})),function(t){t[t.Replace=0]="Replace",t[t.Different=1]="Different"}(i=t.LoadPolicy||(t.LoadPolicy={}));var a=function(){this.type="default"};t.Target=a;var u,h=function(){};t.CallbackContext=h,function(t){t[t.Loaded=0]="Loaded",t[t.Reload=1]="Reload",t[t.Add=2]="Add",t[t.Remove=3]="Remove"}(u=t.PageStatus||(t.PageStatus={}));var l=function(){};t.Page=l;var c=function(){function t(){this.unloadList=new Array,this.loadList=new Array}return t.prototype.merge=function(t){return this.unloadList=this.unloadList.concat(t.unloadList),this.loadList=this.loadList.concat(t.loadList),this},t}();t.Operation=c;var f=function(){},p=function(){function p(){this.routeTable=[],this.forest=new Array,this.history=new t.History(30,this),this.filters=new Array,this.settings={},this.mountHandlers={},this.eventChain=new t.EventChain,this.suspend=!1,this.submitRecorder=new f,this.deathTime=3e4,this.sameSubmitInterval=2e3,this.defaultOpsType=r.Put,this.doc=document}return p.prototype.addMountHandler=function(t,e){return this.mountHandlers[t]=e,this},p.prototype.getMountHandler=function(t){return this.mountHandlers[t]},p.prototype.removeMountHandler=function(t){return this.mountHandlers[t]&&delete this.mountHandlers[t],this},p.prototype.addFilter=function(t){return this.filters.push(t),this},p.prototype.removeFilter=function(e){var r;r="string"==t.Utils.type(e)?e:e.name;for(var n=0;n<this.filters.length&&r!=this.filters[n].name;n++);return n<this.filters.length&&this.filters.splice(n,1),this},p.prototype.doFilters=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(t==e.Before){for(var i=0;i<this.filters.length;i++)if(this.filters[i].before&&0==(o=this.filters[i].before.apply(this,r)))return o;return!0}if(t==e.Mount){for(i=0;i<this.filters.length;i++)if(this.filters[i].mount&&0==(o=this.filters[i].mount.apply(this,r)))return o;return!0}if(t==e.Ready){for(i=0;i<this.filters.length;i++)if(this.filters[i].ready&&0==(o=this.filters[i].ready.apply(this,r)))return o;return!0}if(t==e.UnMount){for(i=0;i<this.filters.length;i++)if(this.filters[i].unMount&&0==(o=this.filters[i].unMount.apply(this,r)))return o;return!0}for(i=0;i<this.filters.length;i++){var o;if(this.filters[i].destroy&&0==(o=this.filters[i].destroy.apply(this,r)))return o}return!0},p.prototype.addRoute=function(e){var r={};if(t.Utils.extend(!0,r,e),!r.path){var n=r.name||"";r.path="/"+n}this.routeTable[r.path]=r},p.prototype.removeRoute=function(t){var e=this.routeTable[t];return e&&delete this.routeTable[t],e},p.prototype.getRoute=function(e){var r=this.matchBestPath(e,this.routeTable);if(r){var n={};return t.Utils.extend(!0,n,this.routeTable[r]),n}},p.prototype.matchBestPath=function(t,e){for(var r=t,n=t.length;-1!=n;){if(void 0!==e[r])return r;-1!==(n=r.lastIndexOf("/"))&&(r=r.substring(0,n))}},p.prototype.addRouteTable=function(e){if("array"===t.Utils.type(e))for(var r in e)this.addRoute(r);else for(var n in e)r={path:"/"+n,component:e[n]},this.addRoute(r)},p.prototype.clearRouteTable=function(){this.routeTable={}},p.prototype.setDefaultRootId=function(t){this.setDefaultRoot(t)},p.prototype.setDefaultRoot=function(t){this.settings.root=t},p.prototype.getDefaultRoot=function(){return this.settings.root},p.prototype.setDefaultOpsType=function(t){this.defaultOpsType=t},p.prototype.getDefaultOpsType=function(){return this.defaultOpsType},p.prototype.setSameSubmitInterval=function(t){this.sameSubmitInterval=t},p.prototype.getSameSubmitInterval=function(){return this.sameSubmitInterval},p.prototype.lock=function(){this.suspend=!0},p.prototype.unlock=function(){this.suspend=!1},p.prototype.isLocked=function(){return this.suspend},p.prototype.canSubmit=function(t,e){return!this.isLocked()&&(this.submitRecorder&&this.submitRecorder.path===t&&this.submitRecorder.time&&e-this.submitRecorder.time<this.deathTime?(this.submitRecorder.time=e,!1):(this.submitRecorder.path=t,this.submitRecorder.time=e,this.submitRecorder.stamp=e,!0))},p.prototype.resetSubmit=function(t,e){this.submitRecorder&&this.submitRecorder.path===t&&this.submitRecorder.stamp===e&&(this.submitRecorder.path="")},p.prototype.replace=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(1==n.length&&"object"==t.Utils.type(n[0]))e=n[0];else{e=new a;for(var o=0;o<n.length;o++)0==o?0==n[o].indexOf("/")?e.path=n[o]:e.path="/"+n[o]:1==o?e.data=n[o]:2==o?e.root=n[o]:3==o&&(e.options=n[o])}return e.options=e.options||{},e.options.operationType=r.Replace,this.to(e)},p.prototype.push=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(1==n.length&&"object"==t.Utils.type(n[0]))e=n[0];else{e=new a;for(var o=0;o<n.length;o++)0==o?0==n[o].indexOf("/")?e.path=n[o]:e.path="/"+n[o]:1==o?e.data=n[o]:2==o?e.root=n[o]:3==o&&(e.options=n[o])}return e.options=e.options||{},e.options.operationType=r.Push,this.to(e)},p.prototype.put=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(1==n.length&&"object"==t.Utils.type(n[0]))e=n[0];else{e=new a;for(var o=0;o<n.length;o++)0==o?0==n[o].indexOf("/")?e.path=n[o]:e.path="/"+n[o]:1==o?e.data=n[o]:2==o?e.root=n[o]:3==o&&(e.options=n[o])}return e.options=e.options||{},e.options.operationType=r.Put,this.to(e)},p.prototype.append=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(1==n.length&&"object"==t.Utils.type(n[0]))e=n[0];else{e=new a;for(var o=0;o<n.length;o++)0==o?0==n[o].indexOf("/")?e.path=n[o]:e.path="/"+n[o]:1==o?e.data=n[o]:2==o?e.root=n[o]:3==o&&(e.options=n[o])}return e.options=e.options||{},e.options.operationType=r.Append,this.to(e)},p.prototype.to=function(){for(var u,h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];if(1==h.length&&"object"==t.Utils.type(h[0]))u=h[0];else{u=new a;for(var c=0;c<h.length;c++)0==c?0==h[c].indexOf("/")?u.path=h[c]:u.path="/"+h[c]:1==c?u.data=h[c]:2==c?u.root=h[c]:3==c&&(u.options=h[c])}if(u.cite={path:u.path,startTime:(new Date).getTime()},!this.canSubmit(u.path,u.cite.startTime)){var f="重复提交["+u.path+"]";return t.logger.error(f),t.errorHandler.handle(s,f),this}var p=this.getRoute(u.path);if(!p)return f="路由信息未注册["+u.path+"]",t.logger.error(f),t.errorHandler.handle(s,f),this;if(u.root||(u.root=p.root),u.root||(u.root=this.settings.root),u.options||(u.options={}),this.lock(),0==this.doFilters(e.Before,u.path,u.data,u.cite))return this.unlock(),this;var d=this.resolveRoute(u,p),g=o(u.options.updatePolicy)?u.options.updatePolicy:n.Part,v=o(u.options.loadPolicy)?u.options.loadPolicy:i.Replace,y=o(u.options.operationType)?u.options.operationType:this.defaultOpsType;if(y===r.Append){if(0==this.forest.length)return this.unlock(),this;var m=this.forest[0];u.root=m.target.root}return this.mount(u,d,g,v,y),this},p.prototype.back=function(t){if(this.isLocked())return!1;if(this.lock(),t){var e=-1;if(t.path?e=this.history.lastIndexOf(t.path):t.before&&(e=this.history.lastIndexOf(t.path)-1),-1==e)return this.unlock(),!1;var s=this.history.get(e);return this.history.position(e),s.target.cite||(s.target.cite={}),s.target.cite.back=!0,this.mount(s.target,s.pages,n.All,i.Different,r.Put)}return s=this.history.go(-1),o(s)?(s.target.cite||(s.target.cite={}),s.target.cite.back=!0,this.mount(s.target,s.pages,n.All,i.Different,r.Put)):(this.unlock(),!1)},p.prototype.remove=function(t){if(this.isLocked())return!1;if(this.lock(),0==this.forest.length)return this.unlock(),!1;var e=this.clonePages(),o=this.lastIndexWindPage(e);if(-1==o)return this.unlock(),!1;var s=!1;if(t){if(t.all){var u=this.removeWinPages(e);if(0===u.length)return this.unlock(),!1;for(var h=u[0],l=0,c=1;c<u.length;c++)u[c].target.path===h.target.path&&l++;for(var f=void 0,p=this.history.lastIndexOf(h.target.path,r.Append);-1!=p&&l>0;)p=this.history.lastIndexOf(h.target.path,r.Append,p-1),l--;if(-1!=p){var d=p-1;this.history.position(d)&&(f=this.history.get(d).target)}f||((f=new a).path=""),f.cite=f.cite||{},f.cite.startTime=(new Date).getTime(),s=this.mount(f,e,n.All,i.Different,r.Put)}else if(t.path){if(-1==(d=this.lastIndexWindPageOf(t.path,e)))return this.unlock(),!1;if(h=e[o],e.splice(o,1),f=void 0,-1!=(p=this.history.lastIndexOf(h.target.path,r.Append))){var g=p-1;this.history.position(g)&&(f=this.history.get(g).target)}f||((f=new a).path=""),f.cite=f.cite||{},f.cite.startTime=(new Date).getTime(),s=this.mount(f,e,n.All,i.Different,r.Put)}}else h=e[o],e.splice(o,1),f=void 0,-1!=(p=this.history.lastIndexOf(h.target.path,r.Append))&&(d=p-1,this.history.position(d)&&(f=this.history.get(d).target)),f||((f=new a).path=""),f.cite=f.cite||{},f.cite.startTime=(new Date).getTime(),s=this.mount(f,e,n.All,i.Different,r.Put);return this.unlock(),s},p.prototype.resolveRouteUnit=function(e,r,n,i,o,s,u,h){if(u.component){if((y=new a).path=r,y.root=o,y.data=i,y.component=u.component,y.options=t.Utils.extend({},s),(m=new l).target=y,m.root=o,m.parent=h,e.push(m),u.children){var c,f=n.indexOf("/");c=-1==f?"":0==f?n.length>1?-1==(f=n.indexOf("/",1))?"":n.substring(f+1,n.length):"":n.substring(f+1,n.length);for(var p=void 0,d=0;d<u.children.length;d++){var g=u.children[d];if(g.path===c){p=g;break}}p&&this.resolveRouteUnit(e,r,c,i,u.child_root,s,p,m)}}else if(u.components)for(var v in u.components){var y,m;(y=new a).path=r,y.root=o,y.data=i,y.component=u.components[v],y.options=t.Utils.extend({},s),(m=new l).target=y,m.root=o,m.parent=h,e.push(m)}},p.prototype.resolveRoute=function(t,e){var r=new Array;return this.resolveRouteUnit(r,t.path,t.path,t.data,t.root,t.options,e,void 0),r},p.prototype.isSameComponent=function(t,e){return t===e||t.html===e.html&&t.js===e.js&&t.css===e.css},p.prototype.isSameTarget=function(e,r){return!!this.isSameComponent(e.component,r.component)&&!!t.Utils.isEqual(e.data,r.data)},p.prototype.clonePages=function(){for(var t=[],e=0;e<this.forest.length;e++)t.push(this.forest[e]);return t},p.prototype.updateBranch=function(t,e,r,o,s){for(var a=new c;e.length>0;){var h=e[0],l=this.lastIndexRootOf(h.root,r,0);if(-1!=l){var f=r[l];if(s===i.Different&&this.isSameTarget(h.target,f.target)){var p=this.removeChildPages(h,e);e.splice(0,1);var d=this.removeChildPages(f,r);r.splice(l,1);var g=f;g.status=u.Loaded,a.loadList.push(g);var v=this.updateBranch(g,p,d,o,s);a.merge(v)}else{var y=this.removePagesUnderRoot(f.root,r);for(b=0;b<y.length;b++)y[b].status=u.Remove,a.unloadList.push(y[b]);for(h.parent=t,m=this.removePagesUnderRoot(h.root,e),b=0;b<m.length;b++)m[b].status=u.Add,a.loadList.push(m[b])}}else{for(var m=this.removePages(h,e),b=0;b<m.length;b++)m[b].status=u.Add,a.loadList.push(m[b]);h.parent=t}}if(r.length>0)if(o==n.All)for(b=0;b<r.length;b++)r[b].status=u.Remove,a.unloadList.push(r[b]);else for(b=r.length-1;b>=0;b--)r[b].status=u.Loaded,a.loadList.unshift(r[b]);return a},p.prototype.updateTree=function(t,e,r,i){var o=new c;if(0==e.length){for(var s=0;s<t.length;s++)t[s].status=u.Add,o.loadList.push(t[s]);return o}if(0==t.length){if(r==n.All)for(s=0;s<e.length;s++)e[s].status=u.Remove,o.unloadList.push(e[s]);else for(s=0;s<e.length;s++)e[s].status=u.Loaded,o.loadList.push(e[s]);return o}if(t[0].root==e[0].root){var a=this.updateBranch(void 0,t,e,r,i);o.merge(a)}else{for(var h=t[0],l=-1,f=e.length-1;f>=0;f--){var p=e[f];if(this.isChildNode(p.root,h.root)){l=f;break}}if(-1==l){for(s=0;s<e.length;s++)e[s].status=u.Loaded,o.loadList.push(e[s]);for(s=0;s<t.length;s++)t[s].status=u.Add,o.loadList.push(t[s])}else{var d=e[l],g=this.removeChildPages(d,e);for(a=this.updateBranch(d,t,g,r,i),o.merge(a),s=l;s>=0;s--)e[s].status=u.Loaded,o.loadList.unshift(e[s]);for(s=l+1;s<e.length;s++)e[s].status=u.Loaded,o.loadList.push(e[s])}}return o},p.prototype.update=function(t,e,n){var i=this.clonePages();if(0===t.length||0===i.length)return this.updateTree(t,i,e,n);for(var o=[],s=t.length-1;s>=0;s--)if((h=t[s]).target.options.operationType===r.Append){var a=this.removePages(h,t);o.unshift({path:h.target.path,pages:a})}var u=[];for(s=i.length-1;s>=0;s--){var h;(h=i[s]).target.options.operationType===r.Append&&(a=this.removePages(h,i),u.unshift({path:h.target.path,pages:a}))}var l=this.updateTree(t,i,e,n);for(s=0;s<u.length;s++){for(var c=u[s],f=-1,p=0;p<o.length;p++)if(c.path===o[p].path){f=p;break}var d=void 0;if(-1==f)d=this.updateTree([],c.pages,e,n);else{var g=o[f];o.splice(s,1),d=this.updateTree(g.pages,c.pages,e,n)}l.merge(d)}for(s=0;s<o.length;s++){var v=o[s];d=this.updateTree(v.pages,[],e,n),l.merge(d)}return l},p.prototype.mount=function(n,i,a,l,c){var f=this,p=n.cite.startTime||-1,d=this.update(i,a,l);if(d){var g=(new Date).getTime();t.logger.debug("重构树["+n.path+"]耗时:"+(g-p)+"毫秒")}d.savepoint=this.forest,this.forest=d.loadList;for(var v=d.loadList.length,y=function(e){e?c===r.Append||c===r.Push?f.history.push(n,d.loadList):c===r.Replace&&f.history.replace(n,d.loadList):f.forest=d.savepoint,f.submitRecorder.path===n.path&&(f.sameSubmitInterval>0?setTimeout((function(){f.resetSubmit(n.path,p)}),f.sameSubmitInterval):f.resetSubmit(n.path,p));var i=(new Date).getTime();t.logger.debug("路由加载完成["+n.path+"]耗时:"+(i-n.cite.startTime)+"毫秒")},m=function(){if(d.unloadList&&d.unloadList.length>0){for(var t=d.unloadList.length-1;t>=0;t--){var e=d.unloadList[t];f.releasePage(e)}d.unloadList=[]}},b=function(r){var i=d.loadList[r];if(i.status===u.Loaded)return"continue";var a=i.target;a.cite=t.Utils.extend(a.cite||{},n.cite),a.cite.path=a.path;var l=new h;l.breakup=m,l.callback=function(r,n){if(0!==r)return y(!1),t.logger.error("mount失败"),f.eventChain.reset(),void t.errorHandler.handle(s,"mount失败");o(n)||(n={});var h=(new Date).getTime();if(t.logger.debug("打开页面["+a.path+"]耗时:"+(h-a.cite.startTime)+"毫秒"),n.ready)try{f.doFilters(e.Ready,n,a.path,a.data,a.cite),n.ready(a.path,a.data,a.cite)}catch(e){t.logger.error(e.Message,e),t.errorHandler.handle(s,e.Message,e)}i.exports=n,i.status=u.Loaded,f.eventChain.fire()};var c=a.type||"default",p=x.getMountHandler(c);x.eventChain.post((function(){try{p.mount(a,l,f)}catch(e){t.logger.error(e.Message,e),f.eventChain.reset(),t.errorHandler.handle(s,e.Message,e)}}))},x=this,w=0;w<v;w++)b(w);return this.eventChain.post((function(){m(),y(!0),f.eventChain.fire()})),this.unlock(),!0},p.prototype.releasePage=function(r){var n=r.target,i=r.exports;if(!o(i))return!0;var a=n.type||"default",u=this.getMountHandler(a);try{return u.unMount(n,i,this),i.destroy&&(this.doFilters(e.Destroy,i,n.path,n.cite),i.destroy.call(i,n.path,n.cite)),n.options&&"function"===t.Utils.type(n.options.callback)&&n.options.callback.call(i,n.path,n.cite),!0}catch(e){t.logger.error(e.Message,e),t.errorHandler.handle(s,e.Message,e)}return!1},p.prototype.unMount=function(t){if(this.isLocked())return!1;if(this.lock(),0==this.forest.length)return this.unlock(),!1;var e;if("number"==typeof t){if(t<0||t>=this.forest.length)return this.unlock(),!1;var o=(e=this.clonePages())[t];if(0==this.removePages(o,e).length)return this.unlock(),!1}else if("string"==typeof t){if(e=this.clonePages(),0==this.removePagesUnderRoot(t,e).length)return this.unlock(),!1}else if(e=this.clonePages(),o=t,0==this.removePages(o,e).length)return this.unlock(),!1;var s=new a;return s.path="",s.cite={path:"",startTime:(new Date).getTime()},this.mount(s,e,n.Part,i.Different,r.Replace),!0},p.prototype.isChildNode=function(e,r){var n="string"===t.Utils.type(e)?this.doc.getElementById(e):e;if(!n)return!1;var i="string"===t.Utils.type(r)?this.doc.getElementById(r):r;if(!i)return!1;for(var o=i.parentNode;o!=n&&o!=this.doc;)o=o.parentNode;return o==n},p.prototype.sendMessage=function(e,r,n){"/"!==e.charAt(0)&&(e="/"+e);for(var i=[],o=0;o<this.forest.length;o++){var a=this.forest[o];if(a.target.path===e){var u=a.exports;if(u&&u.onmessage){var h=a.target.cite||{},l=u.onmessage.call(u,r,n,h);i.push(l)}else{var c="exports或exports.onMessage未定义";i.push(c),t.logger.error(c),t.errorHandler.handle(s,c)}}}return 1==i.length?i[0]:i},p.prototype.indexPageOf=function(t,e,r){for(var n=r=r||0;n<e.length;n++)if(e[n].target.path===t)return n;return-1},p.prototype.indexRootOf=function(t,e,r){for(var n=r=r||0;n<e.length;n++)if(e[n].root==t)return n;return-1},p.prototype.lastIndexRootOf=function(t,e,r){for(var n=r=r||e.length-1;n>=0;n--)if(e[n].root==t)return n;return-1},p.prototype.lastIndexWindPage=function(t){for(var e=t.length-1;e>=0;e--)if(t[e].target.options.operationType===r.Append)return e;return-1},p.prototype.lastIndexWindPageOf=function(t,e){for(var n=e.length-1;n>=0;n--){var i=e[n];if(i.target.options.operationType===r.Append&&i.target.path===t)return n}return-1},p.prototype.removePages=function(t,e){for(var r=[],n=0;n<e.length;){var i=e[n];t===i?(e.splice(n,1),r.push(i)):i.parent===t?(e.splice(n,1),r.push(i)):-1!==r.indexOf(i.parent)?(e.splice(n,1),r.push(i)):n++}return r},p.prototype.removeChildPages=function(t,e){for(var r=[],n=0;n<e.length;){var i=e[n];i.parent===t?(e.splice(n,1),r.push(i)):-1!==r.indexOf(i.parent)?(e.splice(n,1),r.push(i)):n++}return r},p.prototype.removePagesUnderRoot=function(t,e){for(var r=[],n=0;n<e.length;){var i=e[n];i.root===t?(e.splice(n,1),r.push(i)):-1!==r.indexOf(i.parent)?(e.splice(n,1),r.push(i)):n++}return r},p.prototype.removeWinPages=function(t){for(var e=[],n=0;n<t.length;){var i=t[n];i.target.options.operationType===r.Append?(t.splice(n,1),e.push(i)):-1!==e.indexOf(i.parent)?(t.splice(n,1),e.push(i)):n++}return e},p}();t.Router=p,t.router=new p}(t.core||(t.core={}))}(r||(r={})),(r||(r={})).os=function(t){for(var e={},r=[function(e){return t.match(/(Windows)[\s\/]+/)&&(e.windows=!0,e.isTouch="ontouchstart"in window||-1!==t.indexOf("touch")||-1!==t.indexOf("mobile")),1==e.windows},function(e){var r=t.match(/(Android);?[\s\/]+([\d.]+)?/);return r&&(e.android=!0,e.version=r[2],e.isBadAndroid=!/Chrome\/\d/.test(window.navigator.appVersion),e.isTouch="ontouchstart"in window||-1!==t.indexOf("touch")||-1!==t.indexOf("mobile")),!0===e.android},function(e){var r=t.match(/(iPhone\sOS)\s([\d_]+)/);if(r)e.ios=e.iphone=!0,e.version=r[2].replace(/_/g,"."),e.isTouch="ontouchstart"in window||-1!==t.indexOf("touch")||-1!==t.indexOf("mobile");else{var n=t.match(/(iPad).*OS\s([\d_]+)/);n&&(e.ios=e.ipad=!0,e.version=n[2].replace(/_/g,"."),e.isTouch="ontouchstart"in window||-1!==t.indexOf("touch")||-1!==t.indexOf("mobile"))}return!0===e.ios}],n=0;n<r.length&&1!=r[n](e);n++);return e}(window.navigator.userAgent),function(t){t.type=t.core.Utils.type,t.isFunction=t.core.Utils.isFunction,t.isArray=t.core.Utils.isArray,t.makeArray=t.core.Utils.makeArray,t.merge=t.core.Utils.merge,t.isWindow=t.core.Utils.isWindow,t.isPlainObject=t.core.Utils.isPlainObject,t.extend=t.core.Utils.extend,t.clone=t.core.Utils.clone,t.isArrayLike=t.core.Utils.isArrayLike,t.each=t.core.Utils.each,t.isEqual=t.core.Utils.isEqual,t.getInnerText=t.core.Utils.getInnerText,t.setInnerText=t.core.Utils.setInnerText,t.getNextElementSibling=t.core.Utils.getNextElementSibling,t.getFirstElementChild=t.core.Utils.getFirstElementChild,t.require=t.core.require,t.router=t.core.router,t.logger=t.core.logger,t.eventproxy=new t.core.EventProxy,t.bus=new t.core.Bus,t.EventChain=t.core.EventChain,t.errorHandler=t.core.errorHandler;var e=window,r=t;t.config=function(n){var i=n.namespace;i&&("string"==typeof i&&(i=[i]),t.core.Utils.each(i,(function(t,n){e[n]=r}))),t.core.require.config(n)},e.fox=t}(r||(r={}))}])}}]);