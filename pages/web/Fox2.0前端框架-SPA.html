<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fox2.0 前端框架(SPA) | Fox-Wikis</title>
    <meta name="description" content="全新的FOX">
    <link rel="icon" href="/app.ico">
    
    <link rel="preload" href="/assets/css/0.styles.d5b61a21.css" as="style"><link rel="preload" href="/assets/js/app.6be13b1b.js" as="script"><link rel="preload" href="/assets/js/2.cf95f4ea.js" as="script"><link rel="preload" href="/assets/js/42.c6aade2a.js" as="script"><link rel="prefetch" href="/assets/js/10.6373c5aa.js"><link rel="prefetch" href="/assets/js/11.ce8823c8.js"><link rel="prefetch" href="/assets/js/12.369b204f.js"><link rel="prefetch" href="/assets/js/13.f191ade8.js"><link rel="prefetch" href="/assets/js/14.e133e94d.js"><link rel="prefetch" href="/assets/js/15.13c19680.js"><link rel="prefetch" href="/assets/js/16.99c95a04.js"><link rel="prefetch" href="/assets/js/17.ed98f0a2.js"><link rel="prefetch" href="/assets/js/18.c85ba4b9.js"><link rel="prefetch" href="/assets/js/19.fd53435f.js"><link rel="prefetch" href="/assets/js/20.c4327384.js"><link rel="prefetch" href="/assets/js/21.78f7cd1a.js"><link rel="prefetch" href="/assets/js/22.cb27264f.js"><link rel="prefetch" href="/assets/js/23.d5d46f2b.js"><link rel="prefetch" href="/assets/js/24.dcd5fa4c.js"><link rel="prefetch" href="/assets/js/25.f1e3a420.js"><link rel="prefetch" href="/assets/js/26.d18fdf33.js"><link rel="prefetch" href="/assets/js/27.d48d31d7.js"><link rel="prefetch" href="/assets/js/28.a6f9bb79.js"><link rel="prefetch" href="/assets/js/29.516fcfd7.js"><link rel="prefetch" href="/assets/js/3.4060668e.js"><link rel="prefetch" href="/assets/js/30.8b9f22cc.js"><link rel="prefetch" href="/assets/js/31.f0860eb1.js"><link rel="prefetch" href="/assets/js/32.5b7ff02c.js"><link rel="prefetch" href="/assets/js/33.9c96eb94.js"><link rel="prefetch" href="/assets/js/34.4b6ff991.js"><link rel="prefetch" href="/assets/js/35.4552b589.js"><link rel="prefetch" href="/assets/js/36.7e622afa.js"><link rel="prefetch" href="/assets/js/37.194204c8.js"><link rel="prefetch" href="/assets/js/38.4876a45a.js"><link rel="prefetch" href="/assets/js/39.00ee2908.js"><link rel="prefetch" href="/assets/js/4.0d44595b.js"><link rel="prefetch" href="/assets/js/40.6d9d5c8b.js"><link rel="prefetch" href="/assets/js/41.dd73d56e.js"><link rel="prefetch" href="/assets/js/43.5f72f70e.js"><link rel="prefetch" href="/assets/js/44.c9419635.js"><link rel="prefetch" href="/assets/js/45.3b80c2ec.js"><link rel="prefetch" href="/assets/js/46.f0a3a65a.js"><link rel="prefetch" href="/assets/js/47.0d5660ce.js"><link rel="prefetch" href="/assets/js/48.c15f26f1.js"><link rel="prefetch" href="/assets/js/49.8d9e2667.js"><link rel="prefetch" href="/assets/js/5.eaf4b398.js"><link rel="prefetch" href="/assets/js/6.7a92b9fa.js"><link rel="prefetch" href="/assets/js/7.98a19337.js"><link rel="prefetch" href="/assets/js/8.66254435.js"><link rel="prefetch" href="/assets/js/9.0bb35de5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d5b61a21.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Fox-Wikis</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/pages/foxserver/quickstart/新建服务.html" class="nav-link">Fox服务</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Android" class="dropdown-title"><span class="title">Android</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/android/fox2.0/Fox2.0平台环境准备.html" class="nav-link">FoxShell2.0</a></li><li class="dropdown-item"><!----> <a href="/pages/android/fox3.0/Fox3.0 android外壳新特性.html" class="nav-link">FoxShell3.0</a></li></ul></div></div><div class="nav-item"><a href="/pages/ios/Fox3.0 插件开发指南-IOS.html" class="nav-link">IOS</a></div><div class="nav-item"><a href="/pages/web/Fox2.0前端框架-工具介绍.html" class="nav-link">前端框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端组件" class="dropdown-title"><span class="title">前端组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/components/2.0/catButton.html" class="nav-link">2.0.0</a></li><li class="dropdown-item"><!----> <a href="/pages/components/1.0/" class="nav-link">1.0.0</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于作者" class="dropdown-title"><span class="title">关于作者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Archlizz/Archlizz.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jiangch316.github.io/fox_wikis.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/pages/foxserver/quickstart/新建服务.html" class="nav-link">Fox服务</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Android" class="dropdown-title"><span class="title">Android</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/android/fox2.0/Fox2.0平台环境准备.html" class="nav-link">FoxShell2.0</a></li><li class="dropdown-item"><!----> <a href="/pages/android/fox3.0/Fox3.0 android外壳新特性.html" class="nav-link">FoxShell3.0</a></li></ul></div></div><div class="nav-item"><a href="/pages/ios/Fox3.0 插件开发指南-IOS.html" class="nav-link">IOS</a></div><div class="nav-item"><a href="/pages/web/Fox2.0前端框架-工具介绍.html" class="nav-link">前端框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端组件" class="dropdown-title"><span class="title">前端组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/components/2.0/catButton.html" class="nav-link">2.0.0</a></li><li class="dropdown-item"><!----> <a href="/pages/components/1.0/" class="nav-link">1.0.0</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于作者" class="dropdown-title"><span class="title">关于作者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Archlizz/Archlizz.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jiangch316.github.io/fox_wikis.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/web/Fox2.0前端框架-工具介绍.html" class="sidebar-link">工具介绍</a></li><li><a href="/pages/web/Fox2.0前端框架-开发规范.html" class="sidebar-link">开发规范</a></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>插件开发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/web/Fox2.0前端框架-插件-Device接口.html" class="sidebar-link">Device接口</a></li><li><a href="/pages/web/Fox2.0前端框架-插件-Native接口.html" class="sidebar-link">Native接口</a></li></ul></section></li><li><a href="/pages/web/Fox2.0前端框架-服务请求.html" class="sidebar-link">服务请求</a></li><li><a href="/pages/web/Fox2.0前端框架-校验器.html" class="sidebar-link">校验器</a></li><li><a href="/pages/web/Fox2.0前端框架-SPA.html" class="active sidebar-link">单页面框架(SPA)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/web/Fox2.0前端框架-SPA.html#_1-介绍" class="sidebar-link">1 介绍</a></li><li class="sidebar-sub-header"><a href="/pages/web/Fox2.0前端框架-SPA.html#_2-工程结构" class="sidebar-link">2 工程结构</a></li><li class="sidebar-sub-header"><a href="/pages/web/Fox2.0前端框架-SPA.html#_3-前端开发指南" class="sidebar-link">3 前端开发指南</a></li><li class="sidebar-sub-header"><a href="/pages/web/Fox2.0前端框架-SPA.html#_4-后端开发指南-可选" class="sidebar-link">4 后端开发指南(可选)</a></li><li class="sidebar-sub-header"><a href="/pages/web/Fox2.0前端框架-SPA.html#_5-单页面-spa-支持" class="sidebar-link">5 单页面(SPA)支持</a></li></ul></li><li><a href="/pages/web/Fox2.0前端框架-MPA.html" class="sidebar-link">多页面框架(MPA)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="fox2-0-前端框架-spa"><a href="#fox2-0-前端框架-spa" class="header-anchor">#</a> Fox2.0 前端框架(SPA)</h1> <hr> <p></p><div class="table-of-contents"><ul><li><a href="#_1-介绍">1 介绍</a></li><li><a href="#_2-工程结构">2 工程结构</a><ul><li><a href="#_2-1-整体工程结构">2.1 整体工程结构</a></li><li><a href="#_2-2-前端工程结构">2.2 前端工程结构</a></li><li><a href="#_2-3-后端工程结构-可选">2.3 后端工程结构(可选)</a></li></ul></li><li><a href="#_3-前端开发指南">3 前端开发指南</a><ul><li><a href="#_3-1-页面开发">3.1 页面开发</a></li><li><a href="#_3-2-自定义组件开发">3.2 自定义组件开发</a></li><li><a href="#_3-3-主题扩展">3.3 主题扩展</a></li><li><a href="#_3-4-开发规范">3.4 开发规范</a></li></ul></li><li><a href="#_4-后端开发指南-可选">4 后端开发指南(可选)</a><ul><li><a href="#_4-1-服务开发">4.1 服务开发</a></li></ul></li><li><a href="#_5-单页面-spa-支持">5 单页面(SPA)支持</a><ul><li><a href="#_5-1-路由表">5.1 路由表</a></li><li><a href="#_5-2-路由跳转">5.2 路由跳转</a></li></ul></li></ul></div><p></p> <h2 id="_1-介绍"><a href="#_1-介绍" class="header-anchor">#</a> 1 介绍</h2> <p>Fox框架是一个单页Web应用（single page web application，SPA）应用框架，也就是只有一张Web页面的应用。单页应用程序(S PA) 是加载单个HTML页面并在用户与应用程序交互时动态更新该页面的Web应用程序。
Fox框架提倡CMD标准，JS/HMTML/CSS都要求按模块规范编写，并提供HTML、CSS和JS加载，路由跳转，另外还通过插件的形态提供了UI组件，ajax服务访问，web socket，文件上传下载、外设访问等扩展功能。。</p> <h2 id="_2-工程结构"><a href="#_2-工程结构" class="header-anchor">#</a> 2 工程结构</h2> <p>下面将会展示Fox前端框架的整体、前端和后端(可选)的结构，让大家有一个整体的认识。</p> <h3 id="_2-1-整体工程结构"><a href="#_2-1-整体工程结构" class="header-anchor">#</a> 2.1 整体工程结构</h3> <p><img src="http://static.zybuluo.com/jiangch316/o5o4prbbo37xbk6i5vrnyg07/%E6%95%B4%E4%BD%93%E5%B7%A5%E7%A8%8B%E7%BB%93%E6%9E%84.png" alt="整体工程结构.png-434.7kB"></p> <p>如上图所示，工程主要分为前端页面和后端服务目录。前端页面目录主要是放置HTML、CSS、JS和相关的图片等用于web展示的资源文件。而后端服务主要是放置后台渠道访问服务、访问数据库服务等。</p> <h3 id="_2-2-前端工程结构"><a href="#_2-2-前端工程结构" class="header-anchor">#</a> 2.2 前端工程结构</h3> <p><img src="http://static.zybuluo.com/jiangch316/tgs0cnfqt3tslotflzt1jee2/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E7%BB%93%E6%9E%84-spa.png" alt="前端工程结构-spa.png-188.7kB"></p> <p>上图展示的目录结构如下</p> <ul><li>custom目录：放置项目专属的js库、自定义组件等</li> <li>pages目录：放置web page，每个page由html/css/js文件组成</li> <li>libs目录：放置公共js库、组件库等</li> <li>theme目录：放置主题css/font、图片等</li></ul> <h3 id="_2-3-后端工程结构-可选"><a href="#_2-3-后端工程结构-可选" class="header-anchor">#</a> 2.3 后端工程结构(可选)</h3> <p><img src="http://static.zybuluo.com/jiangch316/iw6cc2kz912qxcjs9fr0a6pq/%E5%90%8E%E7%AB%AF%E5%B7%A5%E7%A8%8B%E7%BB%93%E6%9E%84.png" alt="后端工程结构.png-481.6kB"></p> <p>上图展示的目录结构如下</p> <ul><li>filter目录：过滤器，用于截访问服务的请求，例如报文解析、权限检验、输入数据校验等</li> <li>example目录：示例的服务目录，service用于服务逻辑处理</li> <li>配置文件目录：服务配置，用于定义服务的访问路径</li></ul> <h2 id="_3-前端开发指南"><a href="#_3-前端开发指南" class="header-anchor">#</a> 3 前端开发指南</h2> <p>本节主要介绍Fox前端开发的入门基础</p> <h3 id="_3-1-页面开发"><a href="#_3-1-页面开发" class="header-anchor">#</a> 3.1 页面开发</h3> <p>Fox前端框架中最小的单位为page，每个page由html/css/js三个文件组成。可参考例子工程中例子，如下</p> <p><strong>html</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-sub-page</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>interview_01<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-content-padded</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-input-group</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>基本信息'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-text</span> <span class="token attr-name">:autofocus</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>focus</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>my_focus<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>['require']<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-bind:</span>placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入中文姓名'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:inner-tip</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>必输'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>中文信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-text</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-select</span> <span class="token attr-name">:autofocus</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value-type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>text'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入证件类型'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>certificateType<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:datasource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>m_dataSource.certificateType<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>证件类型<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-select</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-number</span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入证件号码'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>certificateNo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>证件号码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-number</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-text</span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入借款用途'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>useType<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>借款用途<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-text</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-text</span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入申请金额(大写)'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:unit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>万元'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>申请金额(大写)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-text</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-money</span> <span class="token attr-name">:decimal-length</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:auto-padding</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入申请金额(小写)'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:unit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>万元'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>申请金额(小写)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-money</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-datetime</span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入申请日期'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{&quot;type&quot;:&quot;date&quot;}<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>申请日期<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-datetime</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-select</span> <span class="token attr-name">:value-type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>json'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>请输入合同类型'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>relType<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:datasource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>m_dataSource.relationShip<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>合同类型<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-select</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-select</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>classData<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selectLayer<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">:datasource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>classList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>班级<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-select</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-input-group</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fox-button</span> <span class="token attr-name">@tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>测试<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-content-padded</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fox-sub-page</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>js</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">/**
     * Created by jiangcheng on 2017/10/24.
     */</span>
    <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;./custom/js/app.data.interview.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
        <span class="token comment">//page加载完成后调用ready方法</span>
        exports<span class="token punctuation">.</span><span class="token function-variable function">ready</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> data<span class="token punctuation">,</span> cite</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
            <span class="token keyword">var</span> vmData<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token comment">//数据源</span>
                m_dataSource<span class="token punctuation">:</span>my_dataSource<span class="token punctuation">,</span>
    
                classList<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;二年级&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;201903251734451&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&quot;children&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;一班&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;201903251734450&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;三班&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;201903251734452&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;二班&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;201903251734451&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;一年级&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;201903251734450&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
    
    
                <span class="token punctuation">,</span>selectLayer<span class="token punctuation">:</span><span class="token punctuation">{</span>
                    layer<span class="token punctuation">:</span> <span class="token number">2</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>cite<span class="token punctuation">.</span>isBack<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">//获取保存的业务数据</span>
                <span class="token keyword">var</span> tempData<span class="token operator">=</span>fox<span class="token punctuation">.</span>bus<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;step_00&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;step_01&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//同步数据</span>
                fox<span class="token punctuation">.</span>custom<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>vmData<span class="token punctuation">,</span>tempData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token comment">//数据</span>
                <span class="token keyword">var</span> tempData<span class="token operator">=</span><span class="token punctuation">{</span>
    
                    name<span class="token punctuation">:</span><span class="token string">&quot;黄飞鸿&quot;</span><span class="token punctuation">,</span>
    
                    certificateType<span class="token punctuation">:</span><span class="token string">&quot;身份证&quot;</span><span class="token punctuation">,</span>
    
                    certificateNo<span class="token punctuation">:</span><span class="token string">&quot;330881198802170219&quot;</span><span class="token punctuation">,</span>
    
                    useType<span class="token punctuation">:</span><span class="token string">&quot;购房&quot;</span><span class="token punctuation">,</span>
    
                    relType<span class="token punctuation">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    
                    classData<span class="token punctuation">:</span><span class="token string">&quot;&quot;</span>
    
    
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
                <span class="token comment">//同步数据</span>
                fox<span class="token punctuation">.</span>custom<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>tempData<span class="token punctuation">,</span>vmData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
    
    
            <span class="token comment">//创建vue model</span>
            <span class="token keyword">var</span> vm<span class="token operator">=</span>fox<span class="token punctuation">.</span>custom<span class="token punctuation">.</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                el<span class="token punctuation">:</span>cite<span class="token punctuation">.</span>el<span class="token punctuation">,</span>
    
                <span class="token comment">//数据</span>
                data<span class="token punctuation">:</span>vmData<span class="token punctuation">,</span>
    
                <span class="token comment">//方法</span>
                methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
    
                    <span class="token function-variable function">my_focus</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        <span class="token comment">// alert(&quot;my-focus&quot;)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
                    <span class="token function-variable function">test</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>relType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
                <span class="token function-variable function">mounted</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                   
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
        <span class="token comment">//消息处理</span>
        exports<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> message<span class="token punctuation">,</span> cite</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
        <span class="token comment">//page销毁时触发destroy方法</span>
        exports<span class="token punctuation">.</span><span class="token function-variable function">destroy</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> cite</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><p><strong>CSS</strong></p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>    <span class="token selector">#interview_00</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-2-自定义组件开发"><a href="#_3-2-自定义组件开发" class="header-anchor">#</a> 3.2 自定义组件开发</h3> <p>每个项目都有自己特殊的需求，这是无法在公共组件中提供的，所以我们也提供了自定义组件的扩展机制。自定义组件在custom/templates/my/components.js文件中扩展，建议每个自定义组件的前缀为“my-”，如my-button，my-text等</p> <p><strong>widget</strong>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">/**
     * Created by jiangcheng on 2017/10/2.
     */</span>
    
    <span class="token comment">/**
     * hello
     */</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">vue<span class="token punctuation">,</span> $<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//注册组件</span>
        Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token comment">//模板</span>
            template<span class="token punctuation">:</span> <span class="token string">'\
                   &lt;label&gt;{{text}}&lt;/label&gt;\
                 '</span><span class="token punctuation">,</span>
            data<span class="token punctuation">:</span><span class="token punctuation">{</span>
                text<span class="token punctuation">:</span><span class="token string">&quot;hello world!&quot;</span>
            <span class="token punctuation">}</span>
    
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> $<span class="token punctuation">,</span> <span class="token string">&quot;my-hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_3-3-主题扩展"><a href="#_3-3-主题扩展" class="header-anchor">#</a> 3.3 主题扩展</h3> <p>theme目录下面用于主题扩展，每个项目对css样式都由特殊需求，可以通过css进行重新定制。</p> <h3 id="_3-4-开发规范"><a href="#_3-4-开发规范" class="header-anchor">#</a> 3.4 开发规范</h3> <p><strong>HTML规范</strong> <img src="http://static.zybuluo.com/jiangch316/0gxv28wmssj2hlobzz4xtr9v/html%E8%A7%84%E8%8C%83.png" alt="html规范.png-631kB"></p> <blockquote><p>每个html page的最外层元素都有一个div，并且这个根div的有一个唯一的ID</p></blockquote> <p><strong>CSS规范</strong> <img src="http://static.zybuluo.com/jiangch316/iry3v69h7kq874uqgu6ct7es/css%E8%A7%84%E8%8C%83.png" alt="css规范.png-555kB"></p> <blockquote><p>CSS文件中定义的所有css都应该指定其生效范围，避免产生css污染的风险。其规则为使用对应html的根div的唯一id作为其限制范围。</p></blockquote> <p><strong>JS规范</strong> <img src="http://static.zybuluo.com/jiangch316/yez0atyhogg6rjfef4in5utd/js%E8%A7%84%E8%8C%83.png" alt="js规范.png-257.1kB"></p> <blockquote><p>js模块三个生命周期
1.ready为页面加载完成后调用
2.destroy为页面销毁时加载
3.onmessage为页面间消息处理函数</p></blockquote> <h2 id="_4-后端开发指南-可选"><a href="#_4-后端开发指南-可选" class="header-anchor">#</a> 4 后端开发指南(可选)</h2> <p>这节将会展示如何开发service和过滤器，当然由于前端框架是前后端分离的，所以没规定必须使用fox server作为项目的后端应用服务。</p> <h3 id="_4-1-服务开发"><a href="#_4-1-服务开发" class="header-anchor">#</a> 4.1 服务开发</h3> <p>每个服务由两部分组成：java文件和xml配置文件。java文件用于逻辑处理，而xml文件用于配置服务的访问路径和该服务的过滤器。如下</p> <h4 id="_4-1-1-普通服务开发"><a href="#_4-1-1-普通服务开发" class="header-anchor">#</a> 4.1.1 普通服务开发</h4> <p><strong>java</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">package</span> <span class="token namespace">service<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span>
    
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">BufferedInputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">File</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
    
    <span class="token keyword">import</span> <span class="token namespace">service<span class="token punctuation">.</span>common<span class="token punctuation">.</span>bean</span><span class="token punctuation">.</span><span class="token class-name">JsonRequest</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">service<span class="token punctuation">.</span>common<span class="token punctuation">.</span>bean</span><span class="token punctuation">.</span><span class="token class-name">JsonResponse</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>resource</span><span class="token punctuation">.</span><span class="token class-name">ResourceManager</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>session</span><span class="token punctuation">.</span><span class="token class-name">Session</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>session</span><span class="token punctuation">.</span><span class="token class-name">SessionManager</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>trade</span><span class="token punctuation">.</span><span class="token class-name">Service</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * demo service
     * 
     * @author 江成
     * 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JsonRequest</span><span class="token punctuation">,</span> <span class="token class-name">JsonResponse</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    
    	<span class="token comment">/**
    	 * 构造函数
    	 */</span>
    	<span class="token keyword">public</span> <span class="token class-name">DemoService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		<span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    
    	<span class="token comment">/**
    	 * execute
    	 */</span>
    	<span class="token keyword">public</span> <span class="token class-name">JsonResponse</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">JsonRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token class-name">String</span> s<span class="token operator">=</span>request<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;收到数据:&quot;</span><span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//定义返回数据</span>
    		<span class="token class-name">JsonResponse</span> response<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">JsonResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//获取名称</span>
    		<span class="token class-name">String</span> name<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;江成&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    			response<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;rp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;100 (哇，人品爆棚了good!!!)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    			<span class="token keyword">int</span> rp<span class="token operator">=</span>name<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">100</span><span class="token punctuation">;</span>
    			<span class="token class-name">StringBuilder</span> sb<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>rp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token keyword">if</span><span class="token punctuation">(</span>rp<span class="token operator">&gt;=</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot; (人品不错哦)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>rp<span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot; (人品一般般嘛)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>rp<span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot; (人品真差)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot; (人品那么差，兄弟你从前世就开始做坏事了)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span>
    			
    			response<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;rp&quot;</span><span class="token punctuation">,</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token punctuation">}</span>
    		response<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//response.put(&quot;test&quot;, getData());</span>
    		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;返回数据:&quot;</span><span class="token operator">+</span>response<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">return</span> response<span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    	
    	<span class="token comment">/**
    	 * execute
    	 */</span>
    	<span class="token keyword">public</span> <span class="token class-name">JsonResponse</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">JsonRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token comment">//-------------------------------------------------</span>
    		 <span class="token comment">//登陆成功后获取session,如果之前没有session会创建一个新的session</span>
    		 <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">SessionManager</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    					<span class="token punctuation">.</span><span class="token function">getSessionFromCurrentThread</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		 <span class="token comment">//设置session登录状态为TRUE</span>
    		 session<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//定义返回数据</span>
    	    <span class="token class-name">JsonResponse</span> response<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">JsonResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    response<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;rsp&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    <span class="token keyword">return</span> response<span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    	
    	<span class="token comment">/**
    	 * 获取测试数据
    	 * @return
    	 * @throws Exception
    	 */</span>
    	<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unused&quot;</span><span class="token punctuation">)</span>
    	<span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
    		<span class="token class-name">ResourceManager</span> resourceManager<span class="token operator">=</span><span class="token class-name">ResourceManager</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">String</span> workspaceRoot<span class="token operator">=</span>resourceManager<span class="token punctuation">.</span><span class="token function">getWorkspaceRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">String</span> projectName<span class="token operator">=</span>resourceManager<span class="token punctuation">.</span><span class="token function">getProjectName</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">String</span> path<span class="token operator">=</span>workspaceRoot<span class="token operator">+</span><span class="token string">&quot;/&quot;</span><span class="token operator">+</span>projectName<span class="token operator">+</span><span class="token string">&quot;/resource/para/dataSource/test.txt&quot;</span><span class="token punctuation">;</span>
    		<span class="token class-name">ByteArrayOutputStream</span> byteOut<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">try</span><span class="token punctuation">{</span>
    			<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    			<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    			
    			<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token operator">=</span>in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				byteOut<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span>
    		<span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
    		    in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token punctuation">}</span>
    		<span class="token keyword">return</span> byteOut<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    	
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br></div></div><blockquote><p>服务一般继承Servie或BaseService，逻辑方法中入参为JsonRequest，出参为JsonResponse。当然对于非json格式交互数据的情况，如文件上传、文件下载服务，则需要使用HttpMessage作为入参和出参了</p></blockquote> <p><strong>配置文件</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    &lt;!--继承的名字是文件名,继承的文件必须为abstract为true的文件--&gt;
    &lt;package name=&quot;demo&quot; namespace=&quot;demo&quot; extends=&quot;filter-auth.xml,filter-base.xml,filter-verify.xml&quot;&gt;
    	&lt;!-- demo测试 --&gt;
    	&lt;service name=&quot;demoService&quot; class=&quot;service.example.DemoService&quot;
    			method=&quot;execute&quot;&gt;
    	  &lt;property name=&quot;verify&quot; type=&quot;map&quot;&gt;
    	  	  &lt;item key=&quot;name&quot;&gt;require&lt;/item&gt;
    	  &lt;/property&gt;
    	&lt;/service&gt;
    	&lt;!-- web socket测试 --&gt;
    	&lt;service name=&quot;webSocket&quot; class=&quot;service.example.WebSocketService&quot;
    			method=&quot;execute&quot;&gt;
    	&lt;/service&gt;
    &lt;/package&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><blockquote><p>上面配置文件中定义了服务的访问路径、过滤器链路和对应的服务实现文件和方法。访问路径有三部分组成：package-name/namespace/name，如上面的访问路径如下 demo/demo/demoService。访问该服务需要通过filter-auth.xml,filter-base.xml,filter-verify.xml三个配置文件中定义的过滤器，而该服务对应的实现类为service.example.DemoService，而对应方法为execute。</p></blockquote> <h4 id="_4-1-2-文件上传服务开发"><a href="#_4-1-2-文件上传服务开发" class="header-anchor">#</a> 4.1.2 文件上传服务开发</h4> <p><strong>java</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">package</span> <span class="token namespace">service<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span>
    
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">BufferedOutputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">File</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">FileOutputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">OutputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">RandomAccessFile</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Arrays</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">List</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Map</span><span class="token punctuation">;</span>
    
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>communication<span class="token punctuation">.</span>http</span><span class="token punctuation">.</span><span class="token class-name">FileItem</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>communication<span class="token punctuation">.</span>http</span><span class="token punctuation">.</span><span class="token class-name">HttpMessage</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>resource</span><span class="token punctuation">.</span><span class="token class-name">ResourceManager</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>trade</span><span class="token punctuation">.</span><span class="token class-name">Service</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * 文件上传服务
     * 
     * @author 江成
     *
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UploadService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HttpMessage</span><span class="token punctuation">,</span><span class="token class-name">HttpMessage</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
    
    	<span class="token comment">/**
    	 * 执行
    	 */</span>
    	<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    	<span class="token keyword">public</span> <span class="token class-name">HttpMessage</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token class-name">HttpMessage</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-------------------&gt; start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>request<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		
    		<span class="token comment">//文件item </span>
    		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileItem</span><span class="token punctuation">&gt;</span></span> fileItems  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileItem</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//路径</span>
    		<span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    	
    		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token operator">:</span>map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    			<span class="token comment">//获取item</span>
    			<span class="token class-name">Object</span> item<span class="token operator">=</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			
    			<span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token keyword">instanceof</span> <span class="token class-name">FileItem</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;0----&gt; fileItem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			    fileItems<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">FileItem</span><span class="token punctuation">)</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				<span class="token class-name">String</span> name<span class="token operator">=</span>key<span class="token punctuation">;</span>
    				<span class="token class-name">Object</span> value<span class="token operator">=</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;1----&gt; name:&quot;</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">&quot; ,values:&quot;</span><span class="token operator">+</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    				<span class="token class-name">String</span> name<span class="token operator">=</span>key<span class="token punctuation">;</span>
    				<span class="token class-name">Object</span> value<span class="token operator">=</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;2----&gt; name:&quot;</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">&quot; ,value:&quot;</span><span class="token operator">+</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    					path<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>value<span class="token punctuation">;</span>
    				<span class="token punctuation">}</span>
    			<span class="token punctuation">}</span>
    		<span class="token punctuation">}</span>
    		
    		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>size<span class="token operator">=</span>fileItems<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    			<span class="token class-name">FileItem</span> fileItem<span class="token operator">=</span>fileItems<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token class-name">InputStream</span> in<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    			<span class="token class-name">OutputStream</span> out <span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    			
    			<span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;fileName-&quot;</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token keyword">try</span><span class="token punctuation">{</span>
    				in<span class="token operator">=</span>fileItem<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token class-name">ResourceManager</span> resMg<span class="token operator">=</span><span class="token class-name">ResourceManager</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token class-name">String</span> installRoot<span class="token operator">=</span>resMg<span class="token punctuation">.</span><span class="token function">getInstallRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token class-name">StringBuilder</span> sb<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>installRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------------&gt;写入文件路径 path=&quot;</span><span class="token operator">+</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				
    				<span class="token class-name">File</span> file<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token class-name">File</span> parent <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>parent<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    					parent<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token punctuation">}</span>
    				<span class="token comment">//写入数据</span>
    				out<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			    <span class="token keyword">int</span> len<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    			    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    			    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token operator">=</span>in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    			    	out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			    <span class="token punctuation">}</span>
    			    out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
    				<span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    					<span class="token keyword">try</span><span class="token punctuation">{</span>
    						in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    					<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    						<span class="token comment">//do nothing</span>
    					<span class="token punctuation">}</span>
    				<span class="token punctuation">}</span>
    				
    				<span class="token keyword">if</span><span class="token punctuation">(</span>out<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    					<span class="token keyword">try</span><span class="token punctuation">{</span>
    						out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    					<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    						<span class="token comment">//do nothing</span>
    					<span class="token punctuation">}</span>
    				<span class="token punctuation">}</span>
    			<span class="token punctuation">}</span>	
    		<span class="token punctuation">}</span>
    		
    		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-------------------&gt; end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    <span class="token class-name">HttpMessage</span> response<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HttpMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    response<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">&quot;上传成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">return</span> response<span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    	
    	
    	<span class="token comment">/**
    	 * 上传大文件
    	 */</span>
    	<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    	<span class="token keyword">public</span> <span class="token class-name">HttpMessage</span> <span class="token function">uploadBigFile</span><span class="token punctuation">(</span><span class="token class-name">HttpMessage</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-------------------&gt; start big&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>request<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//记录文件名</span>
    		<span class="token class-name">String</span> fileName<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;fileName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//记录片段开始位置</span>
    		<span class="token keyword">long</span> start<span class="token operator">=</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//当前索引</span>
    		<span class="token keyword">int</span> index<span class="token operator">=</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//切片数量</span>
    		<span class="token keyword">int</span> count<span class="token operator">=</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//获取片段数据</span>
    		<span class="token class-name">FileItem</span> fileItem<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">FileItem</span><span class="token punctuation">)</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		
    		<span class="token comment">//定义byte数据流</span>
    		<span class="token class-name">ByteArrayOutputStream</span> byteOut<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//定义输入流</span>
    		<span class="token class-name">InputStream</span> in<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    		<span class="token keyword">try</span><span class="token punctuation">{</span>
    			<span class="token comment">//获取输入流</span>
    			in<span class="token operator">=</span>fileItem<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				 <span class="token class-name">HttpMessage</span> response<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HttpMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				 response<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">&quot;上传数据无效&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				 <span class="token keyword">return</span> response<span class="token punctuation">;</span>
    			<span class="token punctuation">}</span>
    			
    			<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    			<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    			<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token operator">=</span>in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				byteOut<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span>
    		<span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
    			<span class="token keyword">if</span><span class="token punctuation">(</span>in<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				<span class="token comment">//关闭输入流</span>
    				<span class="token keyword">try</span><span class="token punctuation">{</span>
    					in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    					<span class="token comment">//do nothing</span>
    				<span class="token punctuation">}</span>
    			<span class="token punctuation">}</span>
    		<span class="token punctuation">}</span>
    		
    		<span class="token comment">//获取文件路径</span>
    		<span class="token class-name">ResourceManager</span> resMg<span class="token operator">=</span><span class="token class-name">ResourceManager</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">String</span> installRoot<span class="token operator">=</span>resMg<span class="token punctuation">.</span><span class="token function">getInstallRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">StringBuilder</span> sb<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>installRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;/upload/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">String</span> filePath<span class="token operator">=</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		
    		<span class="token comment">//定义临时文件名</span>
    		<span class="token class-name">String</span> tmpFilePath<span class="token operator">=</span>filePath<span class="token operator">+</span><span class="token string">&quot;.tmp&quot;</span><span class="token punctuation">;</span>
    		<span class="token class-name">File</span> tempFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>tmpFilePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">File</span> parent <span class="token operator">=</span> tempFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>parent<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    			parent<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token punctuation">}</span>
    		
    		<span class="token comment">//定义文件访问器</span>
    		<span class="token class-name">RandomAccessFile</span> randomFile<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    		<span class="token keyword">try</span><span class="token punctuation">{</span>
    			<span class="token comment">//创建文件访问器</span>
    			randomFile<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">RandomAccessFile</span><span class="token punctuation">(</span>tmpFilePath<span class="token punctuation">,</span> <span class="token string">&quot;rw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			randomFile<span class="token punctuation">.</span><span class="token function">seek</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			randomFile<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>byteOut<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
    			<span class="token comment">//关闭文件访问器</span>
    			<span class="token keyword">if</span><span class="token punctuation">(</span>randomFile<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				<span class="token keyword">try</span><span class="token punctuation">{</span>
    					randomFile<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    					<span class="token comment">//do nothing</span>
    				<span class="token punctuation">}</span>
    			<span class="token punctuation">}</span>
    		<span class="token punctuation">}</span>
    		<span class="token comment">//传输完成，修改为正常的文件名称</span>
    		<span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token operator">==</span>count<span class="token punctuation">)</span><span class="token punctuation">{</span>
    			<span class="token class-name">File</span> file<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>tmpFilePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    			file<span class="token punctuation">.</span><span class="token function">renameTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;写入文件:&quot;</span><span class="token operator">+</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token punctuation">}</span>
    		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;写入片段 fileName:&quot;</span><span class="token operator">+</span>fileName<span class="token operator">+</span><span class="token string">&quot;, index:&quot;</span><span class="token operator">+</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;, count:&quot;</span><span class="token operator">+</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;, start:&quot;</span><span class="token operator">+</span>start<span class="token operator">+</span><span class="token string">&quot;, end:&quot;</span><span class="token operator">+</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    <span class="token class-name">HttpMessage</span> response<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HttpMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    response<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">&quot;上传成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-------------------&gt; end big&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">return</span> response<span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    
    
    	<span class="token annotation punctuation">@Override</span>
    	<span class="token keyword">public</span> <span class="token class-name">HttpMessage</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">HttpMessage</span> arg0<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br></div></div><p><strong>配置文件</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    &lt;!--继承的名字是文件名,继承的文件必须为abstract为true的文件--&gt;
    &lt;package name=&quot;demo&quot; namespace=&quot;file&quot; extends=&quot;filter-auth.xml&quot;&gt;
    	&lt;!--直接文件上传 --&gt;
    	&lt;service name=&quot;upload&quot; class=&quot;service.example.UploadService&quot;
    		method=&quot;uploadFile&quot;&gt;
    	&lt;/service&gt;
    	&lt;!--直接文件上传 --&gt;
    	&lt;service name=&quot;uploadBig&quot; class=&quot;service.example.UploadService&quot;
    		method=&quot;uploadBigFile&quot;&gt;
    	&lt;/service&gt;
    	&lt;!--直接文件下载 --&gt;
    	&lt;service name=&quot;download&quot; class=&quot;service.example.DownloadService&quot;
    		method=&quot;downloadFile&quot;&gt;
    	&lt;/service&gt;
    &lt;/package&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>上面文件上传服务中，由于数据为流，所以必须使用HttpMessage作为参数</p></blockquote> <h4 id="_4-1-3-文件下载服务开发"><a href="#_4-1-3-文件下载服务开发" class="header-anchor">#</a> 4.1.3 文件下载服务开发</h4> <p><strong>java</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">package</span> <span class="token namespace">service<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span>
    
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">BufferedInputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">File</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Map</span><span class="token punctuation">;</span>
    
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>communication<span class="token punctuation">.</span>http</span><span class="token punctuation">.</span><span class="token class-name">HttpMessage</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>resource</span><span class="token punctuation">.</span><span class="token class-name">ResourceManager</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * 下载服务
     * @author 江成
     *
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DownloadService</span> <span class="token punctuation">{</span>
    
    	<span class="token comment">/**
    	 * 构造函数
    	 */</span>
    	<span class="token keyword">public</span> <span class="token class-name">DownloadService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		<span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    	
    	<span class="token comment">/**
    	 * 执行
    	 */</span>
    	<span class="token keyword">public</span> <span class="token class-name">HttpMessage</span> <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token class-name">HttpMessage</span> httpMessage<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token comment">// 获取请求参数</span>
    		<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    		<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> reqMap <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> httpMessage
    				<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> reqMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	
    		<span class="token class-name">ResourceManager</span> resMg<span class="token operator">=</span><span class="token class-name">ResourceManager</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">String</span> installRoot<span class="token operator">=</span>resMg<span class="token punctuation">.</span><span class="token function">getInstallRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">StringBuilder</span> sb<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>installRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------------&gt;读取文件路径 path=&quot;</span><span class="token operator">+</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		
    		<span class="token class-name">File</span> file<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	    
    	    <span class="token class-name">HttpMessage</span> respMsg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		respMsg<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/octet-stream&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		respMsg<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">return</span> respMsg<span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p><strong>配置文件</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    &lt;!--继承的名字是文件名,继承的文件必须为abstract为true的文件--&gt;
    &lt;package name=&quot;demo&quot; namespace=&quot;file&quot; extends=&quot;filter-auth.xml&quot;&gt;
    	&lt;!--直接文件上传 --&gt;
    	&lt;service name=&quot;upload&quot; class=&quot;service.example.UploadService&quot;
    		method=&quot;uploadFile&quot;&gt;
    	&lt;/service&gt;
    	&lt;!--直接文件上传 --&gt;
    	&lt;service name=&quot;uploadBig&quot; class=&quot;service.example.UploadService&quot;
    		method=&quot;uploadBigFile&quot;&gt;
    	&lt;/service&gt;
    	&lt;!--直接文件下载 --&gt;
    	&lt;service name=&quot;download&quot; class=&quot;service.example.DownloadService&quot;
    		method=&quot;downloadFile&quot;&gt;
    	&lt;/service&gt;
    &lt;/package&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>上面文件下载服务中，由于数据为流，所以必须使用HttpMessage作为参数</p></blockquote> <p>###4.2 过滤器开发
过滤器同样由java和配置文件两部分组成，下面就用一个权限过滤器为例子，给大家展示过滤器如何开发。</p> <p><strong>java</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">package</span> <span class="token namespace">service<span class="token punctuation">.</span>common<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>
    
    <span class="token keyword">import</span> <span class="token namespace">both<span class="token punctuation">.</span>common<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">LoggerUtil</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>communication<span class="token punctuation">.</span>http</span><span class="token punctuation">.</span><span class="token class-name">HttpMessage</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>session</span><span class="token punctuation">.</span><span class="token class-name">Session</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>session</span><span class="token punctuation">.</span><span class="token class-name">SessionManager</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>trade<span class="token punctuation">.</span>filter</span><span class="token punctuation">.</span><span class="token class-name">Event</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>com<span class="token punctuation">.</span>bankit<span class="token punctuation">.</span>phoenix<span class="token punctuation">.</span>trade<span class="token punctuation">.</span>filter</span><span class="token punctuation">.</span><span class="token class-name">Filter</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * 消息解析过滤器
     * 
     * @author 江成
     * 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthFilter</span> <span class="token keyword">extends</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    
    	<span class="token comment">/**
    	 * 构造函数
    	 */</span>
    	<span class="token keyword">public</span> <span class="token class-name">AuthFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		<span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    
    	<span class="token comment">/**
    	 * before
    	 */</span>
    	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token class-name">Event</span> e<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token comment">//获取session manager</span>
    		<span class="token class-name">SessionManager</span> sessionManager <span class="token operator">=</span> <span class="token class-name">SessionManager</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//获取session</span>
    		<span class="token class-name">Session</span> session <span class="token operator">=</span> sessionManager<span class="token punctuation">.</span><span class="token function">getSessionFromCurrentThread</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		
    		<span class="token comment">//由于是集群部署，session不可能在每台服务器都存在，所以如果内存中</span>
    		<span class="token comment">//session不存在，那旧必须在HTTP message中获取sessionId，去数据库</span>
    		<span class="token comment">//中校验，并还原</span>
    		<span class="token keyword">if</span><span class="token punctuation">(</span>session <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    			<span class="token comment">// 获取入参</span>
    			<span class="token class-name">Object</span> inBean <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getInBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token keyword">if</span> <span class="token punctuation">(</span>inBean <span class="token keyword">instanceof</span> <span class="token class-name">HttpMessage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    				<span class="token class-name">HttpMessage</span> httpSession <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpMessage</span><span class="token punctuation">)</span>inBean<span class="token punctuation">;</span>
    				<span class="token class-name">String</span> id <span class="token operator">=</span> httpSession<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;sessionId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    				   <span class="token comment">//------读取数据库的登陆信息，检查session是否有效--------</span>
    				   <span class="token comment">//检查代码写在这里</span>
    				   <span class="token comment">//------------------------------------------------------</span>
    					
    				   <span class="token comment">//使用指定的ID创建session	</span>
    				   session <span class="token operator">=</span> sessionManager<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				   <span class="token comment">//绑定session到当前线程</span>
    				   sessionManager<span class="token punctuation">.</span><span class="token function">bindSessionToCurrentThread</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span>
    				   <span class="token comment">//设置session的登陆状态</span>
    				   session<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				   
    				   <span class="token comment">//-------还原session信息----------</span>
    				   session<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;江成&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				   <span class="token comment">//-------------------------------</span>
    					
    				<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    					<span class="token class-name">LoggerUtil</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;无法校验session-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    					<span class="token comment">// 抛出异常</span>
    					<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;unlogin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token punctuation">}</span>
    			<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    				<span class="token class-name">LoggerUtil</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;无法校验session-2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token comment">// 抛出异常</span>
    				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;unlogin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span>
    		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    			<span class="token comment">// 获取登录状态</span>
    			<span class="token class-name">Boolean</span> loginStatus <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">isLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>loginStatus<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    				<span class="token class-name">LoggerUtil</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;用户尚未登录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    				<span class="token comment">// 抛出异常</span>
    				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;unlogin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    			<span class="token punctuation">}</span>
    		<span class="token punctuation">}</span>
    		
    	<span class="token punctuation">}</span>
    
    	<span class="token comment">/**
    	 * after
    	 */</span>
    	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">after</span><span class="token punctuation">(</span><span class="token class-name">Event</span> e<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    		<span class="token comment">// do nothing</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div><p><strong>配置文件</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    &lt;package name=&quot;filter-auth&quot; abstract=&quot;true&quot;&gt;
    	&lt;!-- 权限 filter --&gt;
    	&lt;filter name=&quot;AuthFilter&quot;  class=&quot;service.common.filter.AuthFilter&quot; scope=&quot;singleton&quot;&gt;
        &lt;/filter&gt;
    &lt;/package&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_5-单页面-spa-支持"><a href="#_5-单页面-spa-支持" class="header-anchor">#</a> 5 单页面(SPA)支持</h2> <p>本节将会展示对SPA应用的支持</p> <h3 id="_5-1-路由表"><a href="#_5-1-路由表" class="header-anchor">#</a> 5.1 路由表</h3> <p>在Fox前端框架中，所有开发的page都必须把页面注册到路由表中，路由表目录在custom/route-tables下，并且必须把路由文件在custom/main.js中引用</p> <p><strong>路由表</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">/**
     * Created by 江成 on 2017/03/05.
     */</span>
    <span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//定义路由表</span>
        <span class="token keyword">var</span> routeTable<span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token comment">//frame</span>
            frame<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                html<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/frame/frame.html&quot;</span><span class="token punctuation">,</span>
                css<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/frame/frame.css&quot;</span><span class="token punctuation">,</span>
                js<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/frame/frame.js&quot;</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">,</span>components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                html<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/components/components.html&quot;</span><span class="token punctuation">,</span>
                js<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/components/components.js&quot;</span><span class="token punctuation">,</span>
                css<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/components/components.css&quot;</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">,</span>devices<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                html<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/device/devices/devices.html&quot;</span><span class="token punctuation">,</span>
                js<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/device/devices/devices.js&quot;</span><span class="token punctuation">,</span>
                css<span class="token punctuation">:</span> <span class="token string">&quot;pages/phone/example/device/devices/devices.css&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//注册路由表</span>
        fox<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">addRouteTable</span><span class="token punctuation">(</span>routeTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><blockquote><p>规则为路由id：html/css/js路径</p></blockquote> <p><strong>main.js中引用</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">//路由表</span>
        <span class="token keyword">var</span> route_tables <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">'./custom/route-tables/phone/route.silk.pure.js'</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.silk.js'</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.silk.device.js'</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.silk.tutorial.js'</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.silk.scene.js'</span>
            <span class="token comment">//拾光校园</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.school.js'</span>
            <span class="token comment">//客户信息采集</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.interview.js'</span>
            <span class="token comment">//融联创金融</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.finance.js'</span>
            <span class="token comment">//统一门户</span>
            <span class="token punctuation">,</span><span class="token string">'./custom/route-tables/phone/route.unified_portal.js'</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_5-2-路由跳转"><a href="#_5-2-路由跳转" class="header-anchor">#</a> 5.2 路由跳转</h3> <p>Fox前端框架提供了路由跳转的功能，目前路由具备两种，一为内容替换、二为窗口打开。</p> <h4 id="_5-2-1-to-back"><a href="#_5-2-1-to-back" class="header-anchor">#</a> 5.2.1 to/back</h4> <p><strong>router.to</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>     <span class="token comment">//定义传递参数</span>
    <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">//页面跳转 参数列表为(id，data，rootId)，id:页面为唯一标志，在route table中注册;                     //data:父亲页面要传递到子页面的数据；rootId：目标页面要嵌入的div的id</span>
    fox<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">&quot;step_2&quot;</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>router.back</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>     fox<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_5-2-2-append-remove"><a href="#_5-2-2-append-remove" class="header-anchor">#</a> 5.2.2 append/remove</h4> <p><strong>router.append</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>     <span class="token comment">//定义传递参数</span>
    <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">//页面跳转 参数列表为(id，data)，id:页面为唯一标志，在route table中注册;                     //data:父亲页面要传递到子页面的数据</span>
    fox<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;step_2&quot;</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>router.remove</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>      fox<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>router.remove 所有窗口</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>     fox<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">{</span>all<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新于:</span> <span class="time">12/18/2019, 4:28:12 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/web/Fox2.0前端框架-校验器.html" class="prev">校验器</a></span> <span class="next"><a href="/pages/web/Fox2.0前端框架-MPA.html">多页面框架(MPA)</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.6be13b1b.js" defer></script><script src="/assets/js/2.cf95f4ea.js" defer></script><script src="/assets/js/42.c6aade2a.js" defer></script>
  </body>
</html>
